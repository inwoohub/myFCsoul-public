# myFCseoul âš½ ( ì¶•êµ¬ ì§ê´€ ì›¹ ì„œë¹„ìŠ¤ )
**í”„ë¡œì¶•êµ¬ ì§ê´€ ê¸°ë¡ & AI ìŠ¹ë¶€ ì˜ˆì¸¡ ì›¹ ì„œë¹„ìŠ¤** <br>
[**https://www.myfcseoul.com/**](https://www.myfcseoul.com/)

> ì§ê´€ ê¸°ë¡ì„ ê´€ë¦¬í•˜ê³  AIë¥¼ í™œìš©í•´ ë‹¤ìŒ ê²½ê¸° ê²°ê³¼ë¥¼ ì˜ˆì¸¡í•˜ëŠ” FCì„œìš¸ íŒ¬ ì „ìš© ì›¹ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.

---

## 0. ëª©ì°¨
> 1.  [ğŸ‘¨â€ğŸ’» í”„ë¡œì íŠ¸ ê°œìš”](#sec-1-overview)
> 2.  [âš’ï¸ ì‚¬ìš© ê¸°ìˆ ](#sec-2-tech)
> 3.  [ğŸŒ ì•„í‚¤í…ì²˜](#sec-3-arch)
> 4.  [ğŸ–¥ï¸ í™”ë©´ êµ¬ì„±](#sec-4-ui)
> 5.  [ğŸ“Œ ì£¼ìš” ê¸°ëŠ¥ ì„¤ê³„](#sec-5-feature)
> 6.  [âš ï¸ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…](#sec-6-trouble)

---

<a id="sec-1-overview"></a>
## 1. ğŸ‘¨â€ğŸ’» í”„ë¡œì íŠ¸ ê°œìš”

- í”„ë¡œì íŠ¸ëª…: myFCseoul
- ê°œë°œ ê¸°ê°„: 2025.04 ~ 2025.10 (ì•½ 6ê°œì›”)
- ì¸ì›: 1ì¸ ê°œë°œ



### 1-1. ê°œë°œ ëª©ì 

- í”„ë¡œì¶•êµ¬íŒ€ì„ ì‘ì›í•˜ëŸ¬ ê°€ëŠ” FCì„œìš¸ íŒ¬ë“¤ì´
    - ìì‹ ì˜ ì§ê´€ ê¸°ë¡(ì–¸ì œ, ì–´ë–¤ ê²½ê¸°) ì„ ë‚¨ê¸°ê³ 
    - ë‚˜ì™€ íŒ€ì˜ ìŠ¹ë¥ ì„ ë¹„êµí•˜ê³ 
    - AIë¡œ ë‹¤ìŒ ê²½ê¸° ê²°ê³¼ë¥¼ ì˜ˆì¸¡í•´ë³´ëŠ” ì¬ë¯¸ë¥¼ ì œê³µí•˜ëŠ” ì›¹ ì„œë¹„ìŠ¤

<br>

<a id="sec-2-tech"></a>
## 2. âš’ï¸ ì‚¬ìš© ê¸°ìˆ 

### 2-1. Backend
<img src="https://img.shields.io/badge/java-007396?style=for-the-badge&logo=OpenJDK&logoColor=white"> <img src="https://img.shields.io/badge/Spring-6DB33F?style=for-the-badge&logo=Spring&logoColor=white"> <img src="https://img.shields.io/badge/springboot-6DB33F?style=for-the-badge&logo=springboot&logoColor=white"> <img src="https://img.shields.io/badge/MySQL-4479A1?style=for-the-badge&logo=MySQL&logoColor=white"> <img src="https://img.shields.io/badge/Hibernate-59666C?style=for-the-badge&logo=Hibernate&logoColor=white"> <img src="https://img.shields.io/badge/chatGPT-74aa9c?style=for-the-badge&logo=openai&logoColor=white"> <img src="https://img.shields.io/badge/-selenium-%43B02A?style=for-the-badge&logo=selenium&logoColor=white">


### 2-2. Frontend
<img src="https://img.shields.io/badge/JavaScript-F7DF1E?style=for-the-badge&logo=JavaScript&logoColor=white"> <img src="https://img.shields.io/badge/HTML5-E34F26?style=for-the-badge&logo=HTML5&logoColor=white"> <img src="https://img.shields.io/badge/CSS3-1572B6?style=for-the-badge&logo=CSS3&logoColor=white"> <img src="https://img.shields.io/badge/React-61DAFB?style=for-the-badge&logo=React&logoColor=white">


### 2-3. Infra & DevOps
<img src="https://img.shields.io/badge/Amazon%20RDS-1f77b4?style=for-the-badge&logo=Amazon%20EC2&logoColor=white"> <img src="https://img.shields.io/badge/Amazon%20EC2-FF9900?style=for-the-badge&logo=Amazon%20EC2&logoColor=white"> <img src="https://img.shields.io/badge/Amazon%20S3-569A31?style=for-the-badge&logo=Amazon%20S3&logoColor=white"> <img src="https://img.shields.io/badge/nginx-%23009639.svg?style=for-the-badge&logo=nginx&logoColor=white"> <img src="https://img.shields.io/badge/docker-%230db7ed?style=for-the-badge&logo=docker&logoColor=white"> <img src="https://img.shields.io/badge/Cloudflare-F38020?style=for-the-badge&logo=Cloudflare&logoColor=white"> 

<br>

<a id="sec-3-arch"></a>
## 3. ğŸŒ ì•„í‚¤í…ì²˜

### 3-1. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

<img width="1280" height="720" alt="Image" src="https://github.com/user-attachments/assets/150a6ccf-f6ac-45a7-94d1-974f16f0c550" />
<br>

### 3-2. DB ì„¤ê³„ (ERD)

<img width="3360" height="2689" alt="Image" src="https://github.com/user-attachments/assets/729863a4-263b-490a-9ca9-3d57c8990360" />
<br>

### 3-3. í”„ë¡œì íŠ¸ êµ¬ì¡°

<details>
<summary>í”„ë¡œì íŠ¸ êµ¬ì¡° í¼ì³ë³´ê¸°</summary>

```text
â”œâ”€â”€ myFCseoul
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ backend
â”‚   â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”‚   â”œâ”€â”€ build.gradle
â”‚   â”‚   â”œâ”€â”€ gradle
â”‚   â”‚   â”œâ”€â”€ gradle.properties
â”‚   â”‚   â”œâ”€â”€ gradlew
â”‚   â”‚   â”œâ”€â”€ gradlew.bat
â”‚   â”‚   â”œâ”€â”€ settings.gradle
â”‚   â”‚   â””â”€â”€ src
â”‚   â”‚       â”œâ”€â”€ main
â”‚   â”‚       â”‚   â”œâ”€â”€ java
â”‚   â”‚       â”‚   â”‚   â””â”€â”€ com
â”‚   â”‚       â”‚   â”‚       â””â”€â”€ myfcseoul
â”‚   â”‚       â”‚   â”‚           â””â”€â”€ backend
â”‚   â”‚       â”‚   â”‚               â”œâ”€â”€ BackendApplication.java
â”‚   â”‚       â”‚   â”‚               â”œâ”€â”€ config
â”‚   â”‚       â”‚   â”‚               â”œâ”€â”€ controller
â”‚   â”‚       â”‚   â”‚               â”œâ”€â”€ dto
â”‚   â”‚       â”‚   â”‚               â”œâ”€â”€ model
â”‚   â”‚       â”‚   â”‚               â”œâ”€â”€ repository
â”‚   â”‚       â”‚   â”‚               â””â”€â”€ service
â”‚   â”‚       â”‚   â””â”€â”€ resources
â”‚   â”‚       â”‚       â”œâ”€â”€ application.properties
â”‚   â”‚       â”‚       â””â”€â”€ templates
â”‚   â”‚       â”‚           â””â”€â”€ home.html
â”‚   â”œâ”€â”€ certbot
â”‚   â”‚   â”œâ”€â”€ log
â”‚   â”‚   â””â”€â”€ www
â”‚   â”œâ”€â”€ docker-compose.yml
â”‚   â”œâ”€â”€ frontend
â”‚   â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”‚   â”œâ”€â”€ README.md
â”‚   â”‚   â”œâ”€â”€ build
â”‚   â”‚   â”œâ”€â”€ config
â”‚   â”‚   â”œâ”€â”€ craco.config.js
â”‚   â”‚   â”œâ”€â”€ default.conf
â”‚   â”‚   â”œâ”€â”€ git
â”‚   â”‚   â”œâ”€â”€ package-lock.json
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ public
â”‚   â”‚   â”œâ”€â”€ scripts
â”‚   â”‚   â””â”€â”€ src
â”‚   â”‚       â”œâ”€â”€ App.css
â”‚   â”‚       â”œâ”€â”€ App.js
â”‚   â”‚       â”œâ”€â”€ App.test.js
â”‚   â”‚       â”œâ”€â”€ components
â”‚   â”‚       â”‚   â””â”€â”€ messenger
â”‚   â”‚       â”œâ”€â”€ css
â”‚   â”‚       â”œâ”€â”€ hooks
â”‚   â”‚       â”œâ”€â”€ index.css
â”‚   â”‚       â”œâ”€â”€ index.js
â”‚   â”‚       â”œâ”€â”€ logo.svg
â”‚   â”‚       â”œâ”€â”€ pages
â”‚   â”‚       â””â”€â”€ reportWebVitals.js
â”‚   â””â”€â”€ nginx
â”‚       â””â”€â”€ default.conf
â””â”€â”€ tree.txt
```
</details> 
<br>

<a id="sec-4-ui"></a>
## 4. ğŸ–¥ï¸ í™”ë©´ êµ¬ì„±
### 4-1. **ë¡œê·¸ì¸ í™”ë©´**
<img width="1453" height="736" alt="Image" src="https://github.com/user-attachments/assets/dcafbe68-7ae0-4b1d-bb9e-3315f33944e4" />
<br>
ì¹´ì¹´ì˜¤ OAuth 2.0ì„ í†µí•´ ê°„í¸í•˜ê²Œ ë¡œê·¸ì¸í•  ìˆ˜ ìˆëŠ” í™”ë©´<br>

---
### 4-2. **ë©”ì¸ í™”ë©´**
<img width="2438" height="2222" alt="Image" src="https://github.com/user-attachments/assets/13adbb0f-800f-4c8e-a737-eb79211e59ee" />
<br>
ê²½ê¸° ì¼ì •, ë‚˜ì˜ ì§ê´€ ì„±ì , ë­í‚¹ì„ í•œëˆˆì— ë³¼ ìˆ˜ ìˆëŠ” ëŒ€ì‹œë³´ë“œ í™”ë©´<br>

---
### 4-3. **ì§ê´€ ë“±ë¡ í™”ë©´**
<img width="1453" height="1179" alt="Image" src="https://github.com/user-attachments/assets/7a93dc28-2d29-43e9-8a93-55f333676366" />
<br>
ê´€ëŒí•œ ê²½ê¸°ì˜ í‹°ì¼“Â·ì˜ˆë§¤ ë‚´ì—­ ì‚¬ì§„ì„ ì—…ë¡œë“œí•˜ì—¬ ì§ê´€ì„ ë“±ë¡í•  ìˆ˜ ìˆëŠ” í™”ë©´  
ë“±ë¡ëœ ì§ê´€ ì •ë³´ëŠ” ì¶œì„ í†µê³„ ë° ìŠ¹ë¥  ë¶„ì„, ë­í‚¹ ì‚°ì •ì— í™œìš©<br>

---
### 4-4. **ë‹¤ì´ì–´ë¦¬ í™”ë©´**
<img width="2408" height="2672" alt="Image" src="https://github.com/user-attachments/assets/09e14743-586c-48f8-93d3-ad85ecb36539" />
<br>
ê²½ê¸° ê´€ëŒ ì†Œê°ê³¼ ì¼ìƒì„ í…ìŠ¤íŠ¸ì™€ ì‚¬ì§„ìœ¼ë¡œ ê¸°ë¡í•  ìˆ˜ ìˆëŠ” ê°œì¸ ë‹¤ì´ì–´ë¦¬ í™”ë©´<br>

---
### 4-5. **AI ê²½ê¸° ì˜ˆì¸¡ í™”ë©´**
<img width="5623" height="2964" alt="Image" src="https://github.com/user-attachments/assets/02df5148-01a6-4edf-9d8f-6b515ab33343" />
<br>
Kë¦¬ê·¸ ìˆœìœ„, ìƒëŒ€ íŒ€ ì „ì , ë‚˜ì˜ ì§ê´€ ê¸°ë¡ì„ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ìŒ ê²½ê¸° ê²°ê³¼ë¥¼ ì˜ˆì¸¡í•´ ì£¼ëŠ” í™”ë©´
OpenAI APIë¥¼ í™œìš©í•˜ì—¬ í•˜ë£¨ 1íšŒ í…ìŠ¤íŠ¸ í˜•íƒœì˜ ìƒì„¸ ì˜ˆì¸¡ ë¦¬í¬íŠ¸ë¥¼ ì œê³µ<br>

---
### 4-6. **ì±„íŒ… í™”ë©´**
<img width="1469" height="740" alt="Image" src="https://github.com/user-attachments/assets/979db278-a3d0-4ac6-95ec-0ff4c5f1feec" />
<br>
ë‹¤ë¥¸ ì‚¬ìš©ìì™€ 1:1ë¡œ ëŒ€í™”í•˜ë©° ì§ê´€ í›„ê¸°ì™€ ì‘ì› ë©”ì‹œì§€ë¥¼ ë‚˜ëˆŒ ìˆ˜ ìˆëŠ” ì±„íŒ… í™”ë©´<br>

---
### 4-7. **í”„ë¡œí•„ í™”ë©´**
<img width="1453" height="736" alt="Image" src="https://github.com/user-attachments/assets/73ea814e-0550-4b09-ba31-67fa13ecf454" />
<br>
ë¡œê·¸ì•„ì›ƒ ë° ë‹‰ë„¤ì„ ë³€ê²½ ê°€ëŠ¥í•œ í™”ë©´<br>

---
### 4-8. **ê´€ë¦¬ì ì¶œì„ ì¸ì¦ í™”ë©´**
<img width="1453" height="736" alt="Image" src="https://github.com/user-attachments/assets/37478a2d-18b3-400f-acbb-af1a3295cc81" />
<br>
ì‚¬ìš©ìê°€ ì œì¶œí•œ ì§ê´€ ì¸ì¦ ì‚¬ì§„ì„ ê´€ë¦¬ì ê³„ì •ì´ ìŠ¹ì¸Â·ê±°ì ˆí•  ìˆ˜ ìˆëŠ” í™”ë©´
ëŒ€ê¸° ì¤‘ì¸ ìš”ì²­ì˜ ê²½ê¸° ì •ë³´ì™€ ì´ë¯¸ì§€ë¥¼ í™•ì¸í•˜ê³  ë²„íŠ¼ í•œ ë²ˆìœ¼ë¡œ ì¶œì„ ì²˜ë¦¬ ìƒíƒœë¥¼ ë³€ê²½ ê°€ëŠ¥<br>


---
### 4-9. **ëª¨ë°”ì¼ í™”ë©´**
<img width="3617" height="5152" alt="Image" src="https://github.com/user-attachments/assets/e32b1c10-59df-4ff8-9e23-6ab6873cb3c4" />
<br>
ëª¨ë°”ì¼ í™˜ê²½ë„ ê³ ë ¤í•˜ì—¬ ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒì„ êµ¬ì„±<br>

---
<br>

<a id="sec-5-feature"></a>
## 5. ğŸ“Œ ì£¼ìš” ê¸°ëŠ¥ ì„¤ê³„
### 5-1. **Kakao ì†Œì…œ ë¡œê·¸ì¸ (OAuth 2.0) ê¸°ëŠ¥**
<img width="805" height="440" alt="Image" src="https://github.com/user-attachments/assets/9bf370bb-22aa-4dff-8c1f-dbf28a55b0f7" />
<br>
ì¹´ì¹´ì˜¤ OAuth 2.0 ê¸°ë°˜ ì†Œì…œ ë¡œê·¸ì¸ì„ í†µí•´ ì‚¬ìš©ìë¥¼ ì¸ì¦í•©ë‹ˆë‹¤. 

#### API ì„¤ê³„

1. **ì‚¬ìš©ì ìš”ì²­**
    - í´ë¼ì´ì–¸íŠ¸ì—ì„œ â€œì¹´ì¹´ì˜¤ ë¡œê·¸ì¸â€ ë²„íŠ¼ í´ë¦­
    - `GET /oauth2/authorization/kakao` ìš”ì²­ìœ¼ë¡œ Spring Security í•„í„° ì²´ì¸ ì§„ì…

2. **OAuth2 ë¡œê·¸ì¸ í•„í„°**
    - `OAuth2LoginAuthenticationFilter` ê°€ ë¡œê·¸ì¸ ì½œë°±(`/login/oauth2/code/kakao`) ìš”ì²­ì„ ê°€ë¡œì±”
    - `OAuth2LoginAuthenticationProvider` ì— ì¸ì¦ ì²˜ë¦¬ë¥¼ ìœ„ì„

3. **Access Token ë°œê¸‰ & ìœ ì € ì •ë³´ ì¡°íšŒ**
    - Providerê°€ ì¹´ì¹´ì˜¤ë¡œë¶€í„° **Access Token** ì„ ë°œê¸‰ë°›ìŒ
    - `OAuth2UserRequest` ìƒì„± í›„  
      `CustomOAuth2UserService.loadUser(userRequest)` í˜¸ì¶œ
    - `super.loadUser(userRequest)` ë¥¼ í†µí•´ ì¹´ì¹´ì˜¤ ìœ ì € ì •ë³´ API(`/v2/user/me`) í˜¸ì¶œ  
      â†’ `id`, `kakao_account.profile.nickname` ë“±ì˜ attributes ìˆ˜ì‹ 

4. **User ì—”í‹°í‹° ë™ê¸°í™”**
    - `UserRepository.findByUserId(kakaoId)` ë¡œ ê¸°ì¡´ ì‚¬ìš©ì ì¡°íšŒ
    - ì—†ìœ¼ë©´ ì‹ ê·œ ìƒì„±, ìˆìœ¼ë©´ ë‹‰ë„¤ì„ ë“± ì •ë³´ ê°±ì‹ 
    - ê¸°ë³¸ ê¶Œí•œì€ `user` ë¡œ ì„¤ì •, ê´€ë¦¬ì ê³„ì •ì€ `role = admin` ìœ¼ë¡œ ê´€ë¦¬
    - DB ì €ì¥ í›„, `DefaultOAuth2User(principal)` ìƒì„±

5. **SecurityContext / ì„¸ì…˜ ì €ì¥**
    - Providerê°€ `principal` ë¡œ `Authentication` ê°ì²´ ìƒì„±
    - `OAuth2LoginAuthenticationFilter` ê°€ ì´ë¥¼ **SecurityContext** ì— ì €ì¥
    - `SecurityContextPersistenceFilter` ê°€ `HttpSession(JSESSIONID)` ê³¼ ë™ê¸°í™”  
      â†’ ì´í›„ ìš”ì²­ë¶€í„°ëŠ” ì„¸ì…˜ ê¸°ë°˜ìœ¼ë¡œ ì¸ì¦ ìƒíƒœ ìœ ì§€

6. **ë¡œê·¸ì¸ ì„±ê³µ ì²˜ë¦¬**
    - `CustomOAuth2AuthenticationSuccessHandler` ì‹¤í–‰
    - `https://www.myfcseoul.com/` ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

7. **ì¸ê°€(Authorization)**
    - `SecurityConfig` ì—ì„œ URL ë³„ ì ‘ê·¼ ê¶Œí•œ ì„¤ì •
        - `/api/admin/**` : `role = admin` ì‚¬ìš©ìë§Œ ì ‘ê·¼
        - `/api/rankings`, `/api/schedule` : ì¸ì¦ ì—†ì´ í—ˆìš©
        - ê·¸ ì™¸ ëŒ€ë¶€ë¶„ì˜ API : ì¸ì¦ í•„ìˆ˜

#### ê´€ë ¨ ì†ŒìŠ¤ ì½”ë“œ

- [SecurityConfig.java](backend/src/main/java/com/myfcseoul/backend/config/SecurityConfig.java)
- [CustomOAuth2UserService.java](backend/src/main/java/com/myfcseoul/backend/service/CustomOAuth2UserService.java)
- [CustomOAuth2AuthenticationSuccessHandler.java](backend/src/main/java/com/myfcseoul/backend/service/CustomOAuth2AuthenticationSuccessHandler.java)
- [UserRepository.java](backend/src/main/java/com/myfcseoul/backend/repository/UserRepository.java)


---

### 5-2. **ì§ê´€ ê¸°ë¡ ê¸°ëŠ¥**
<img width="800" height="436" alt="Image" src="https://github.com/user-attachments/assets/66f27f0b-d777-46ad-aee0-ed064904a34b" />
<br>
ì„¸ì…˜ ê¸°ë°˜ ì¸ì¦ê³¼ Spring Data JPAë¥¼ ì´ìš©í•´ ê²½ê¸°ë³„ ì§ê´€ ì‚¬ì§„ì„ ì œì¶œí•˜ê³  <br>
ë‚˜ì˜ ì¶œì„ ë‚´ì—­ì„ ì¡°íšŒí•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.  

#### API ì„¤ê³„

1. **ì¶œì„ ì‚¬ì§„ ì œì¶œ â€“ `POST /api/mydata/submit`**
   - Request Body (JSON)
     ```json
     {
       "scheduleId": 3,
       "photoKey": "s3/attendance/2025-04-01-xxxx.jpg"
     }
     ```
   - ì²˜ë¦¬ ê³¼ì •
     - `Principal` ì—ì„œ ì¹´ì¹´ì˜¤ ê³ ìœ  IDë¥¼ êº¼ë‚´ `UserRepository.findByUserId(...)` ë¡œ `User` ì¡°íšŒ  
     - `scheduleId` ë¡œ `ScheduleRepository.findById(...)` í˜¸ì¶œ  
     - `(user, schedule)` ì¡°í•©ìœ¼ë¡œ `MyDataRepository.findByUserAndSchedule(...)` ì¡°íšŒ  
       - ì´ë¯¸ ì¡´ì¬í•˜ë©´ í•´ë‹¹ ë ˆì½”ë“œ ì—…ë°ì´íŠ¸  
       - ì—†ìœ¼ë©´ ìƒˆë¡œìš´ `MyData` ì—”í‹°í‹° ìƒì„±
     - `photoKey` ì„¸íŒ…, `attended = 0`(ìŠ¹ì¸ ëŒ€ê¸°) ë¡œ ìƒíƒœ ì €ì¥
   - ì‘ë‹µ
     - `{ "message": "ì¶œì„ ì‚¬ì§„ì´ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤. ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì…ë‹ˆë‹¤." }`

2. **ë‚˜ì˜ ì¶œì„ ë‚´ì—­ ì¡°íšŒ â€“ `GET /api/mydata`**
   - ì²˜ë¦¬ ê³¼ì •
     - `Principal` ë¡œ í˜„ì¬ ë¡œê·¸ì¸ ì‚¬ìš©ìì˜ `userId` í™•ì¸  
     - `UserRepository.findByUserId(...)` ë¡œ `User` ì—”í‹°í‹° ì¡°íšŒ  
     - `MyDataRepository.findByUser(user)` ë¡œ í•´ë‹¹ ì‚¬ìš©ìì˜ ëª¨ë“  ì¶œì„ ë°ì´í„° ì¡°íšŒ
   - ì‘ë‹µ
     - `MyData` ë¦¬ìŠ¤íŠ¸(JSON)  
       - ê° í•­ëª©ì— `attended`(0/1/2), `schedule`(ê²½ê¸° ì •ë³´), `photoKey` í¬í•¨  
       - í”„ë¡ íŠ¸ì—ì„œ ì§ê´€ íˆìŠ¤í† ë¦¬/ì¶œì„ í˜„í™©/ê·¸ë˜í”„ ë“±ì— í™œìš©

#### ê´€ë ¨ ì†ŒìŠ¤ ì½”ë“œ

- [MyDataController.java](backend/src/main/java/com/myfcseoul/backend/controller/MyDataController.java)
- [AdminMyDataController.java](backend/src/main/java/com/myfcseoul/backend/controller/AdminMyDataController.java)
- [MyDataRepository.java](backend/src/main/java/com/myfcseoul/backend/repository/MyDataRepository.java)
- [ScheduleRepository.java](backend/src/main/java/com/myfcseoul/backend/repository/ScheduleRepository.java)



---

### 5-3. **ë­í‚¹ ê¸°ëŠ¥**
<img width="874" height="329" alt="Image" src="https://github.com/user-attachments/assets/3bc99b20-3aed-4456-8ed0-166601ff50c9" />
<br>
ì§ê´€ ê¸°ë¡ê³¼ ê²½ê¸° ê²°ê³¼ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë­í‚¹ì„ ê³„ì‚°í•˜ì—¬ ë©”ì¸ í˜ì´ì§€ì— ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤. ë­í‚¹ ê³„ì‚°ì€ í•œ ë²ˆë§Œ ìˆ˜í–‰í•˜ê³ , ê·¸ ê²°ê³¼ë¥¼ ì„œë²„ ë©”ëª¨ë¦¬ ìºì‹œì— ì €ì¥í•´ ë¹ ë¥´ê²Œ ì¡°íšŒí•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.

---

#### API ì„¤ê³„

1. **ë­í‚¹ ì¡°íšŒ â€“ `GET /api/rankings`**

    - **ìš”ì²­ íŒŒë¼ë¯¸í„°**
        - ì—†ìŒ (ì „ì²´ ë­í‚¹ì„ í•œ ë²ˆì— ì¡°íšŒ)

    - **ì²˜ë¦¬ ê³¼ì •**
        1. `RankingController.getRankings()` í˜¸ì¶œ
           ```java
           @GetMapping("/rankings")
           public RankingResponse getRankings() {
               return rankingService.getCachedRanking();
           }
           ```
        2. `RankingService.getCachedRanking()` ì—ì„œ
            - ë©”ëª¨ë¦¬ì— ìºì‹œëœ `RankingResponse cache` ë¥¼ ë°˜í™˜
            - ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ ì§í›„ ë“±ìœ¼ë¡œ `cache == null` ì¸ ê²½ìš°  
              `refreshCache()` ë¥¼ í•œ ë²ˆ ì‹¤í–‰í•˜ì—¬ ìºì‹œë¥¼ ì±„ìš´ ë’¤ ë°˜í™˜
        3. ìµœì¢…ì ìœ¼ë¡œ ì•„ë˜ êµ¬ì¡°ì˜ JSON ì„ ë°˜í™˜
            - `attendanceKings` : ì§ê´€ íšŸìˆ˜ ìƒìœ„ Nëª…
            - `winFairies` : ì§ê´€ ìŠ¹ë¥  ìƒìœ„ Nëª…

    - **ì‘ë‹µ ì˜ˆì‹œ**
      ```json
      {
        "attendanceKings": [
          { "nickname": "ì§ê´€1ë“±", "attendanceCount": 15 }
        ],
        "winFairies": [
          {
            "nickname": "ìŠ¹ë¦¬ìš”ì •1",
            "totalAttendance": 10,
            "winCount": 8,
            "winRate": 80.0
          }
        ]
      }
      ```

---

#### ë‚´ë¶€ ë™ì‘ êµ¬ì„±

1. **ë­í‚¹ ì‘ë‹µ DTO â€“ `RankingResponse`**

    - **í•„ë“œ**
        - `List<AttendanceRankDTO> attendanceKings`
            - ë‹‰ë„¤ì„ + ì§ê´€ íšŸìˆ˜
        - `List<WinRateRankDTO> winFairies`
            - ë‹‰ë„¤ì„ + ì´ ì§ê´€ ìˆ˜ + ìŠ¹ë¦¬ ìˆ˜ + ìŠ¹ë¥ (%)

    - ë­í‚¹ ì¡°íšŒ ê²°ê³¼ë¥¼ í•˜ë‚˜ì˜ ê°ì²´ë¡œ ë¬¶ì–´ `/api/rankings` ì‘ë‹µ ë°”ë””ë¡œ ì§ë ¬í™”í•˜ëŠ” ì—­í• ì„ í•œë‹¤.

2. **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë° ìºì‹± â€“ `RankingService`**

    - **í•„ë“œ**
        - `UserRepository userRepo` : ë­í‚¹ ê³„ì‚°ì— í•„ìš”í•œ ì§‘ê³„ ì¿¼ë¦¬ ì œê³µ
        - `private volatile RankingResponse cache;`
            - ì„œë²„ ë©”ëª¨ë¦¬ì— ì €ì¥ë˜ëŠ” ë­í‚¹ ìºì‹œ
            - `volatile` ë¡œ ì—¬ëŸ¬ ìŠ¤ë ˆë“œì—ì„œ í•­ìƒ ìµœì‹  ê°’ì´ ë³´ì´ë„ë¡ ë³´ì¥

    - **ì£¼ìš” ë©”ì„œë“œ**
        - `refreshCache()`
          ```java
          @Scheduled(cron = "0 0 0 * * *", zone = "Asia/Seoul")
          public void refreshCache() {
              var top5 = PageRequest.of(0, 5);
              List<AttendanceRankDTO> attends = userRepo.findTopAttendance(top5);
              List<WinRateRankDTO>    wins    = userRepo.findTopWinRate(top5);
   
              cache = new RankingResponse(attends, wins);
              System.out.println("ã€RankingServiceã€‘ ë­í‚¹ ìºì‹œ ì—…ë°ì´íŠ¸: " + cache);
          }
          ```
            - ë§¤ì¼ 00:00(Asia/Seoul) ì— ìŠ¤ì¼€ì¤„ëŸ¬ê°€ ì‹¤í–‰
            - `UserRepository` ì˜ ì§‘ê³„ ì¿¼ë¦¬ë¥¼ í†µí•´
                - ì§ê´€ íšŸìˆ˜ TOP N
                - ì§ê´€ ìŠ¹ë¥  TOP N
                  ì„ ì¡°íšŒ
            - ì¡°íšŒ ê²°ê³¼ë¥¼ ìƒˆë¡œìš´ `RankingResponse` ë¡œ ë§Œë“¤ì–´ `cache` í•„ë“œì— ì €ì¥  
              â†’ ë‹¤ì´ì–´ê·¸ë¨ ìƒì˜ **Server Memory Cache** ì—…ë°ì´íŠ¸
            - ìƒì„±ìì—ì„œë„ í•œ ë²ˆ í˜¸ì¶œí•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ ì‹œ ì¦‰ì‹œ ìºì‹œë¥¼ ì±„ì›€
        - `getCachedRanking()`
          ```java
          public RankingResponse getCachedRanking() {
              if (cache == null) {
                  refreshCache();
              }
              return cache;
          }
          ```
            - ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ í˜¸ì¶œí•˜ëŠ” ë©”ì„œë“œë¡œ,  
              ì´ë¯¸ ê³„ì‚°ëœ ìºì‹œê°€ ìˆë‹¤ë©´ ê·¸ëŒ€ë¡œ ë°˜í™˜í•˜ê³   
              ì—†ìœ¼ë©´ í•œ ë²ˆë§Œ `refreshCache()` ë¥¼ ìˆ˜í–‰í•œ ë’¤ ë°˜í™˜
            - ë•ë¶„ì— `/api/rankings` ìš”ì²­ë§ˆë‹¤ ë¬´ê±°ìš´ ì§‘ê³„ ì¿¼ë¦¬ë¥¼ ë‹¤ì‹œ ìˆ˜í–‰í•˜ì§€ ì•Šê³ ,  
              **ìºì‹œ ì¡°íšŒë§Œìœ¼ë¡œ ë¹ ë¥´ê²Œ ì‘ë‹µ**í•  ìˆ˜ ìˆë‹¤.

3. **ì§‘ê³„ ì¿¼ë¦¬ â€“ `UserRepository`**

    - **ì§ê´€ì™• â€“ `findTopAttendance(Pageable pageable)`**
      ```java
      @Query("""
          SELECT u.nickname AS nickname,
                 COUNT(md)  AS attendanceCount
            FROM MyData md
            JOIN md.user u
           WHERE md.attended = 1
             AND u.nickname <> 'Unknown'
           GROUP BY u.nickname
           ORDER BY COUNT(md) DESC
          """
      )
      List<AttendanceRankDTO> findTopAttendance(Pageable pageable);
      ```
        - ì§ê´€ ì¸ì¦ ì™„ë£Œ(`attended = 1`)ëœ `MyData` ê¸°ì¤€ìœ¼ë¡œ
            - ìœ ì € ë‹‰ë„¤ì„ë³„ ì§ê´€ íšŸìˆ˜ë¥¼ ì¹´ìš´íŠ¸
            - íšŸìˆ˜ ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬ í›„ ìƒìœ„ Nëª… ë°˜í™˜

    - **ìŠ¹ë¦¬ ìš”ì • â€“ `findTopWinRate(Pageable pageable)`**
      ```java
      @Query("""
          SELECT new com.myfcseoul.backend.dto.WinRateRankDTO(
                   u.nickname,
                   COUNT(md),
                   SUM(CASE WHEN s.result = 'ìŠ¹' THEN 1 ELSE 0 END),
                   SUM(CASE WHEN s.result = 'ìŠ¹' THEN 1 ELSE 0 END) * 100.0 / COUNT(md)
                 )
            FROM MyData md
            JOIN md.user u
            JOIN md.schedule s
           WHERE md.attended = 1
             AND u.nickname <> 'Unknown'
             AND s.result IS NOT NULL
           GROUP BY u.nickname
           HAVING COUNT(md) > 5
           ORDER BY SUM(CASE WHEN s.result = 'ìŠ¹' THEN 1 ELSE 0 END) * 100.0 / COUNT(md) DESC
          """
      )
      List<WinRateRankDTO> findTopWinRate(Pageable pageable);
      ```
        - ì‚¬ìš©ìì˜ ì§ê´€ ê²½ê¸°(`attended = 1`) ì¤‘ ê²°ê³¼ê°€ ìˆëŠ” ê²½ê¸°ë§Œ ëŒ€ìƒìœ¼ë¡œ
            - ì´ ì§ê´€ ìˆ˜(`COUNT(md)`)
            - ìŠ¹ë¦¬ ìˆ˜(`SUM(CASE WHEN s.result = 'ìŠ¹' THEN 1 ELSE 0 END)`)
            - ìŠ¹ë¥ (`winCount * 100.0 / totalAttendance`)
              ë¥¼ í•œ ë²ˆì— ê³„ì‚°
        - `HAVING COUNT(md) > 5` ì¡°ê±´ìœ¼ë¡œ **ìµœì†Œ 5ê²½ê¸° ì´ìƒ ì§ê´€í•œ ì‚¬ìš©ì**ë§Œ í¬í•¨
        - ìŠ¹ë¥  ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬ í›„ ìƒìœ„ Nëª… ë°˜í™˜

---

#### ê´€ë ¨ ì†ŒìŠ¤ ì½”ë“œ

- [RankingController.java](backend/src/main/java/com/myfcseoul/backend/controller/RankingController.java)
- [RankingService.java](backend/src/main/java/com/myfcseoul/backend/service/RankingService.java)
- [RankingResponse.java](backend/src/main/java/com/myfcseoul/backend/dto/RankingResponse.java)
- [AttendanceRankDTO.java](backend/src/main/java/com/myfcseoul/backend/dto/AttendanceRankDTO.java)
- [WinRateRankDTO.java](backend/src/main/java/com/myfcseoul/backend/dto/WinRateRankDTO.java)
- [UserRepository.java](backend/src/main/java/com/myfcseoul/backend/repository/UserRepository.java)

---

### 5-4. **AI ê²½ê¸° ì˜ˆì¸¡ ê¸°ëŠ¥**
<img width="922" height="487" alt="Image" src="https://github.com/user-attachments/assets/675e4e4d-0f57-4fe2-9463-3ee9a4732a85" />
<br>
ì‚¬ìš©ìì˜ ì§ê´€ ê¸°ë¡(ìŠ¹/ë¬´/íŒ¨), Kë¦¬ê·¸ ê³µì‹ ì‚¬ì´íŠ¸ì—ì„œ ìŠ¤í¬ë˜í•‘í•œ í˜„ì¬ ìˆœìœ„ ë° ìµœê·¼ 5ê²½ê¸° í¼
ê·¸ë¦¬ê³  DBì— ì €ì¥ëœ ë‹¤ìŒ ê²½ê¸° ì¼ì • ì •ë³´ë¥¼ ì¢…í•©í•´ì„œ OpenAI GPT ëª¨ë¸ì—ê²Œ í”„ë¡¬í”„íŠ¸ë¥¼ ì „ë‹¬í•˜ê³  ë‹¤ìŒ ê²½ê¸° ê²°ê³¼(ìŠ¹/ë¬´/íŒ¨ + ìŠ¤ì½”ì–´)ë¥¼ ë¶„ì„Â·ì˜ˆì¸¡í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

#### API ì„¤ê³„

1. **ê²½ê¸° ì˜ˆì¸¡ ìš”ì²­ â€“ `GET /api/predict?userId=...` , `POST /api/predict?userId=...`**

    - **ìš”ì²­ íŒŒë¼ë¯¸í„°**
        - `userId` : ì˜ˆì¸¡ì„ ìš”ì²­í•˜ëŠ” ì‚¬ìš©ì ID (ì¹´ì¹´ì˜¤ ê³ ìœ  ID)

    - **ì²˜ë¦¬ ê³¼ì •**
        1. `UserRepository.findById(userId)` ë¡œ ì‚¬ìš©ì ì¡°íšŒ  
           â†’ ì—†ìœ¼ë©´ `401 UNAUTHORIZED` + `"ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."`
        2. **ì¼ë°˜ ì‚¬ìš©ì**ì¸ ê²½ìš°, `lastPredictionAt` ê¸°ì¤€ìœ¼ë¡œ  
           â†’ **í•˜ë£¨ 1íšŒë§Œ ì˜ˆì¸¡ ê°€ëŠ¥**í•˜ë„ë¡ ì œí•œ
            - ì˜¤ëŠ˜ ì´ë¯¸ ì˜ˆì¸¡í–ˆë‹¤ë©´ `429 TOO_MANY_REQUESTS` ë°˜í™˜
        3. `MyDataService.getByUserId(userId)` ë¡œ ì‚¬ìš©ìì˜ ì§ê´€ ë°ì´í„° ì¡°íšŒ
            - ë‚´ë¶€ì—ì„œ `MyDataRepository.findByUserUserIdAndAttended(userId, 1)` ì‹¤í–‰
            - ìŠ¹ì¸ëœ(`attended = 1`) ì§ê´€ ë°ì´í„°ë§Œ í•„í„°ë§
        4. `ScheduleService.getNextMatch()` ë¡œ **ë‹¤ìŒ ê²½ê¸° ì¼ì •** ì¡°íšŒ
        5. `KLeagueScraperService.fetchStandings()` ë¡œ  
           Kë¦¬ê·¸ íŒ€ ìˆœìœ„ + ìµœê·¼ 5ê²½ê¸° í¼(ìŠ¹Â·ë¬´Â·íŒ¨) ìŠ¤í¬ë˜í•‘
        6. ìœ„ ì„¸ ë°ì´í„°ë¥¼ `PromptBuilder.build(...)` ì— ì „ë‹¬í•´  
           â†’ GPTì—ê²Œ ì „ë‹¬í•  **í•œêµ­ì–´ í”„ë¡¬í”„íŠ¸ ë¬¸ìì—´ ìƒì„±**
        7. `OpenAiClientService.getPrediction(prompt)` í˜¸ì¶œ  
           â†’ OpenAI Chat Completions API (`gpt-4.1-mini`)ë¡œ ì˜ˆì¸¡ ê²°ê³¼ ë¬¸ì¥ íšë“
        8. **ì¼ë°˜ ì‚¬ìš©ì**ì¸ ê²½ìš°
            - `user.lastPredictionAt = now()`
            - `user.lastPredictionResult = prediction`  
              ë¡œ DBì— ì €ì¥ (í•˜ë£¨ 1íšŒ ì œí•œ ë° ìºì‹œ ìš©ë„)
        9. ìµœì¢… ì˜ˆì¸¡ ê²°ê³¼ë¥¼ JSONìœ¼ë¡œ ë°˜í™˜:
           ```json
           {
             "prediction": "ì„œìš¸ì´ 2:1ë¡œ ìŠ¹ë¦¬í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤... (ì´í•˜ GPT ì‘ë‹µ)"
           }
           ```

    - **ì‘ë‹µ**
        - ì„±ê³µ: `200 OK` + `{ "prediction": "<AI ì˜ˆì¸¡ ê²°ê³¼ í…ìŠ¤íŠ¸>" }`
        - í•˜ë£¨ 1íšŒ ì œí•œ ì´ˆê³¼: `429 TOO_MANY_REQUESTS`
        - ë¯¸ë¡œê·¸ì¸ ë˜ëŠ” ì˜ëª»ëœ userId: `401 UNAUTHORIZED`

2. **ì˜¤ëŠ˜ì˜ ì˜ˆì¸¡ ê²°ê³¼ ì¡°íšŒ â€“ `GET /api/prediction`**

    - **ì¸ì¦ ë°©ì‹**
        - `Principal` ì„ ì‚¬ìš©í•´ í˜„ì¬ ì„¸ì…˜ì˜ ë¡œê·¸ì¸ ì‚¬ìš©ì ì‹ë³„  
          â†’ `principal.getName()` = ì¹´ì¹´ì˜¤ `userId`

    - **ì²˜ë¦¬ ê³¼ì •**
        1. `principal == null` ì´ë©´ `401 UNAUTHORIZED`
        2. `UserRepository.findById(principal.getName())` ë¡œ ì‚¬ìš©ì ì¡°íšŒ
        3. `user.lastPredictionAt` ì˜ ë‚ ì§œê°€ **ì˜¤ëŠ˜**ì´ê³   
           `lastPredictionResult` ê°€ ì¡´ì¬í•˜ë©´  
           â†’ ì˜¤ëŠ˜ ì´ë¯¸ ìƒì„±í•´ ë‘” ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ê·¸ëŒ€ë¡œ ë°˜í™˜
        4. ì˜¤ëŠ˜ ì˜ˆì¸¡í•œ ê¸°ë¡ì´ ì—†ë‹¤ë©´ `204 No Content` ë°˜í™˜

    - **ì‘ë‹µ ì˜ˆì‹œ**
      ```json
      {
        "prediction": "ì„œìš¸ì´ 1:0ìœ¼ë¡œ ê·¼ì†Œí•˜ê²Œ ìŠ¹ë¦¬í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤..."
      }
      ```

---

#### ë‚´ë¶€ ë™ì‘ êµ¬ì„±

1. **Kë¦¬ê·¸ ìˆœìœ„Â·í¼ ìˆ˜ì§‘ â€“ `KLeagueScraperService`**
    - Selenium(ChromeDriver) + Jsoup ì‚¬ìš©
    - `https://www.kleague.com/record/team.do` ì— ì ‘ì† í›„
        - ê·¸ë£¹ A/B ìˆœìœ„ í…Œì´ë¸”(`#ts1`, `#ts2`)ì—ì„œ
        - íŒ€ëª…, ìˆœìœ„, ìµœê·¼ 5ê²½ê¸° í¼(ìŠ¹Â·ë¬´Â·íŒ¨)ì„ íŒŒì‹±
    - `Standing(group, rank, team, recentForm)` ë¦¬ìŠ¤íŠ¸ë¡œ ë°˜í™˜

2. **í”„ë¡¬í”„íŠ¸ ìƒì„± â€“ `PromptBuilder`**
    - **ì…ë ¥**
        - `List<MyData> myList` : ì‚¬ìš©ìì˜ ìŠ¹ì¸ëœ ì§ê´€ ê¸°ë¡(`attended = 1`)
        - `List<Standing> standings` : í˜„ì¬ ë¦¬ê·¸ ìˆœìœ„/í¼
        - `Schedule nextMatch` : ë‹¤ìŒ ê²½ê¸° ì •ë³´(í™ˆ/ì›ì •, ì¼ì‹œ, ì¥ì†Œ)
    - **ì²˜ë¦¬**
        - ì§ê´€ ìŠ¹/ë¬´/íŒ¨ ì¹´ìš´íŠ¸
        - ìˆœìœ„/í¼ì„ **ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” í˜•ì‹**ìœ¼ë¡œ ë³€í™˜
        - ë‹¤ìŒ ê²½ê¸° ì •ë³´ë¥¼  
          ì˜ˆ) `"ì„œìš¸ vs ëŒ€êµ¬  2025ë…„ 4ì›” 1ì¼ 19ì‹œ 00ë¶„  ì¥ì†Œ: ìƒì•”ì›”ë“œì»µê²½ê¸°ì¥"`  
          ê°™ì€ ë¬¸ì¥ìœ¼ë¡œ í¬ë§·íŒ…
        - â€œì˜ˆì¸¡ ìš”ì²­/ì–‘ì‹/ê·¼ê±° ì‘ì„± ë°©ë²•â€ì„ ìƒì„¸íˆ ì ì€  
          ê¸´ í•œêµ­ì–´ í”„ë¡¬í”„íŠ¸ ë¬¸ìì—´ ìƒì„±
    - **ì¶œë ¥**
        - OpenAI Chat APIì— ê·¸ëŒ€ë¡œ ì „ë‹¬í•  ìµœì¢… `String prompt`

3. **OpenAI í˜¸ì¶œ â€“ `OpenAiClientService`**
    - `POST https://api.openai.com/v1/chat/completions`
    - **Request Body**
      ```json
      {
        "model": "gpt-4.1-mini",
        "messages": [
          { "role": "user", "content": "<PromptBuilderê°€ ë§Œë“  í”„ë¡¬í”„íŠ¸>" }
        ],
        "temperature": 0.2
      }
      ```
    - ì‘ë‹µì—ì„œ `choices[0].message.content` ë¥¼ êº¼ë‚´  
      â†’ ìµœì¢… ì˜ˆì¸¡ ê²°ê³¼ í…ìŠ¤íŠ¸ë¡œ ì‚¬ìš©

---

#### ê´€ë ¨ ì†ŒìŠ¤ ì½”ë“œ

- [PredictionController.java](backend/src/main/java/com/myfcseoul/backend/controller/PredictionController.java)
- [OpenAiClientService.java](backend/src/main/java/com/myfcseoul/backend/service/OpenAiClientService.java)
- [PromptBuilder.java](backend/src/main/java/com/myfcseoul/backend/service/PromptBuilder.java)
- [KLeagueScraperService.java](backend/src/main/java/com/myfcseoul/backend/service/KLeagueScraperService.java)
- [MyDataService.java](backend/src/main/java/com/myfcseoul/backend/service/MyDataService.java)
- [ScheduleService.java](backend/src/main/java/com/myfcseoul/backend/service/ScheduleService.java)

---

### 5-5. **ì±„íŒ… ê¸°ëŠ¥**

<img width="841" height="155" alt="Image" src="https://github.com/user-attachments/assets/fb8501b5-40c1-4201-94b6-e0df9db97dad" />

<img width="856" height="441" alt="Image" src="https://github.com/user-attachments/assets/48be8a28-6ed9-4923-a81a-a662d399613a" />
<br>
Spring WebSocket + STOMP ê¸°ë°˜ì˜ ì‹¤ì‹œê°„ í†µì‹ ìœ¼ë¡œ DM ë°© ìƒì„±, ì €ì¥, ì¡°íšŒê¹Œì§€ ëª¨ë‘ ì„œë²„ì—ì„œ ê´€ë¦¬í•˜ë©° ì‚¬ìš©ìëŠ” ë‹¤ë¥¸ ìœ ì €ì™€ ì‹¤ì‹œê°„ìœ¼ë¡œ ë©”ì‹œì§€ë¥¼ ì£¼ê³ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
<br>

#### API ì„¤ê³„

1. **ì±„íŒ…ë°© ìƒì„±/ì¡°íšŒ â€“ `GET /api/chat/room?senderId=...&receiverId=...`**

    - **ìš”ì²­ íŒŒë¼ë¯¸í„°**
        - `senderId` : ì±„íŒ…ì„ ì‹œì‘í•˜ëŠ” ì‚¬ìš©ì ID (ì¹´ì¹´ì˜¤ ê³ ìœ  ID)
        - `receiverId` : ìƒëŒ€ ì‚¬ìš©ì ID

    - **ì²˜ë¦¬ ê³¼ì •**
        1. `ChatService.getOrCreateRoom(senderId, receiverId)` í˜¸ì¶œ  
           â†’ ë‚´ë¶€ì—ì„œ `ChatRoomRepository.findByUsers(senderId, receiverId)` ì‹¤í–‰  
           â†’ (user1=A, user2=B) ë˜ëŠ” (user1=B, user2=A) ì¡°í•©ìœ¼ë¡œ **ê¸°ì¡´ ë°©ì´ ìˆëŠ”ì§€ ì¡°íšŒ**
        2. ê¸°ì¡´ ë°©ì´ ì—†ë‹¤ë©´
            - `UserRepository.findById(senderId)`
            - `UserRepository.findById(receiverId)`  
              ë¡œ ë‘ ì‚¬ìš©ì ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•˜ê³ 
            - `ChatRoom(user1, user2)` ì—”í‹°í‹°ë¥¼ ìƒì„±í•˜ì—¬ DBì— ì €ì¥
        3. ìµœì¢…ì ìœ¼ë¡œ `roomId` ë¥¼ JSONìœ¼ë¡œ ë°˜í™˜

    - **ì‘ë‹µ ì˜ˆì‹œ**
      ```json
      {
        "roomId": 12
      }
      ```

2. **ì±„íŒ… íˆìŠ¤í† ë¦¬ ì¡°íšŒ â€“ `GET /api/chat/{roomId}`**

    - **ìš”ì²­ ê²½ë¡œ ë³€ìˆ˜**
        - `roomId` : ì±„íŒ…ë°© ID

    - **ì²˜ë¦¬ ê³¼ì •**
        1. `ChatService.getHistory(roomId)` í˜¸ì¶œ  
           â†’ `ChatMessageRepository.findByRoomRoomIdOrderBySentAtAsc(roomId)` ì‹¤í–‰  
           â†’ í•´ë‹¹ ë°©ì˜ ë©”ì‹œì§€ë¥¼ **ì „ì†¡ ì‹œê° ì˜¤ë¦„ì°¨ìˆœ**ìœ¼ë¡œ ì¡°íšŒ
        2. ê° `ChatMessage` ì—”í‹°í‹°ë¥¼ `ChatMessageDTO` ë¡œ ë³€í™˜
            - `roomId`, `senderId`, `content`, `senderNickname`, `sentAt` ë“±ì„ ë§¤í•‘
        3. DTO ë¦¬ìŠ¤íŠ¸ë¥¼ JSON ë°°ì—´ë¡œ ë°˜í™˜

    - **ì‘ë‹µ ì˜ˆì‹œ**
      ```json
      [
        {
          "roomId": 12,
          "senderId": "123456",
          "receiverId": null,
          "content": "ì•ˆë…•í•˜ì„¸ìš”!",
          "senderNickname": "FCì„œìš¸íŒ¬1",
          "sentAt": "2025-05-20 19:11:23.123"
        }
      ]
      ```

3. **ì‹¤ì‹œê°„ 1:1 DM ì „ì†¡ â€“ WebSocket `/ws-chat` + STOMP `/app/chat/private`**

    - **WebSocket/STOMP ì—°ê²°**
        - í´ë¼ì´ì–¸íŠ¸ëŠ” SockJS + STOMP í´ë¼ì´ì–¸íŠ¸ë¡œ  
          `ws://<ì„œë²„>/ws-chat` ì—”ë“œí¬ì¸íŠ¸ì— Handshake ìš”ì²­
        - ì„œë²„ ì„¤ì • (`WebSocketConfig`)
          ```java
          registry.addEndpoint("/ws-chat")
                  .setAllowedOriginPatterns("*")
                  .withSockJS();
   
          registry.setApplicationDestinationPrefixes("/app");
          registry.enableSimpleBroker("/queue");
          ```

    - **í´ë¼ì´ì–¸íŠ¸ â†’ ì„œë²„ (ë©”ì‹œì§€ ì „ì†¡)**
        - í´ë¼ì´ì–¸íŠ¸ëŠ” `/app/chat/private` ëª©ì ì§€ë¡œ STOMP SEND:
          ```json
          {
            "roomId": 12,
            "senderId": "123456",
            "receiverId": "654321",
            "content": "ì•ˆë…•!"
          }
          ```
        - ì´ ë©”ì‹œì§€ëŠ” ì„œë²„ì˜
          ```java
          @MessageMapping("/chat/private")
          public void handlePrivateMessage(@Payload ChatMessageDTO dto) { ... }
          ```
          ë©”ì„œë“œë¡œ ë§¤í•‘ëœë‹¤.

    - **ì„œë²„ ë‚´ë¶€ ì²˜ë¦¬**
        1. DTO ìœ íš¨ì„± ê²€ì‚¬ (senderId/receiverId/content nullÂ·ê³µë°± ì²´í¬)
        2. `ChatService.getOrCreateRoom(senderId, receiverId)` ë¡œ ë°© ì¡°íšŒ/ìƒì„±
        3. `ChatService.saveMessage(roomId, senderId, content)` í˜¸ì¶œ  
           â†’ `ChatRoomRepository.findById(roomId)` + `UserRepository.findById(senderId)`ë¡œ ì—”í‹°í‹° ì¡°íšŒ  
           â†’ `ChatMessage` ì—”í‹°í‹° ìƒì„± í›„ `ChatMessageRepository.saveAndFlush(...)` ë¡œ DBì— ì €ì¥
        4. ì‘ë‹µìš© DTOì— `roomId`, `senderNickname`, `sentAt` ë“±ì„ ì„¸íŒ…

    - **ì„œë²„ â†’ í´ë¼ì´ì–¸íŠ¸ (ë©”ì‹œì§€ í‘¸ì‹œ)**
        - ì €ì¥ í›„, ìˆ˜ì‹ ìì—ê²Œ WebSocketìœ¼ë¡œ ì‹¤ì‹œê°„ ì „ë‹¬:
          ```java
          messagingTemplate.convertAndSendToUser(
              dto.getReceiverId(),
              "/queue/messages",
              dto
          );
          ```
        - ì‹¤ì œ ëª©ì ì§€: `/user/{receiverId}/queue/messages`
        - í´ë¼ì´ì–¸íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬ë…:
          ```js
          stompClient.subscribe('/user/queue/messages', onMessage);
          ```
        - ìˆ˜ì‹ ìëŠ” **ìì‹ ì—ê²Œ ë„ì°©í•œ ë©”ì‹œì§€ë§Œ** ì‹¤ì‹œê°„ìœ¼ë¡œ ì „ë‹¬ë°›ì•„ ì±„íŒ…ì°½ì— ë Œë”ë§í•œë‹¤.

---

#### ë‚´ë¶€ ë™ì‘ êµ¬ì„±

1. **WebSocket/STOMP ì„¤ì • â€“ `WebSocketConfig`**
    - `@EnableWebSocketMessageBroker` + `WebSocketMessageBrokerConfigurer` ë¡œ STOMP ë©”ì‹œì§€ ë¸Œë¡œì»¤ í™œì„±í™”
    - `/ws-chat` ì—”ë“œí¬ì¸íŠ¸ë¥¼ SockJS ê¸°ë°˜ WebSocket ì—”ë“œí¬ì¸íŠ¸ë¡œ ë“±ë¡
    - í´ë¼ì´ì–¸íŠ¸ ë°œì‹  ê²½ë¡œ prefix: `/app`  
      â†’ `/app/chat/private` â†’ `@MessageMapping("/chat/private")` ë¡œ ë§¤í•‘
    - ì„œë²„ ë°œì‹  ê²½ë¡œ prefix: `/queue`  
      â†’ `convertAndSendToUser(userId, "/queue/messages", ...)` í˜¸ì¶œ ì‹œ  
      ì‹¤ì œ ëª©ì ì§€ `/user/{userId}/queue/messages` ë¡œ ë¼ìš°íŒ…

2. **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ â€“ `ChatService`**
    - `getOrCreateRoom(String senderId, String receiverId)`
        - `ChatRoomRepository.findByUsers(senderId, receiverId)`  
          ë¡œ ë‘ ìœ ì € ê°„ ê¸°ì¡´ ë°©ì„ ì¡°íšŒ
        - ì—†ìœ¼ë©´ `UserRepository` ë¡œ ìœ ì € ì—”í‹°í‹° ì¡°íšŒ í›„ ìƒˆ `ChatRoom` ìƒì„± ë° ì €ì¥
        - íŠ¸ëœì­ì…˜(`@Transactional`)ìœ¼ë¡œ ë°© ìƒì„± ê³¼ì • ì „ì²´ë¥¼ í•˜ë‚˜ì˜ ë‹¨ìœ„ë¡œ ë³´ì¥
    - `saveMessage(Long roomId, String senderId, String content)`
        - `ChatRoomRepository.findById(roomId)` ë¡œ ë°© ì¡´ì¬ ì—¬ë¶€ í™•ì¸
        - `UserRepository.findById(senderId)` ë¡œ ë°œì‹ ì ì¡°íšŒ
        - `ChatMessage` ì—”í‹°í‹°ë¥¼ ìƒì„±í•˜ì—¬ `ChatMessageRepository.saveAndFlush(...)` ë¡œ ì €ì¥
    - `getHistory(Long roomId)`
        - `ChatMessageRepository.findByRoomRoomIdOrderBySentAtAsc(roomId)` ë¡œ  
          ë°© ë‚´ ë©”ì‹œì§€ íˆìŠ¤í† ë¦¬ë¥¼ ì‹œê°„ìˆœìœ¼ë¡œ ì¡°íšŒ (`@Transactional(readOnly = true)`)

3. **ì»¨íŠ¸ë¡¤ëŸ¬ ê³„ì¸µ â€“ `ChatRoomController`, `ChatController`**
    - `ChatRoomController`
        - `GET /api/chat/room`  
          â†’ ë‘ ì‚¬ìš©ì(senderId, receiverId) ê°„ DM ë°©ì„ ì¡°íšŒí•˜ê±°ë‚˜ ì—†ìœ¼ë©´ ìƒì„±  
          â†’ `{"roomId": <Long>}` í˜•íƒœë¡œ ì‘ë‹µ
    - `ChatController`
        - `@MessageMapping("/chat/private")`  
          â†’ WebSocket/STOMP ê¸°ë°˜ ì‹¤ì‹œê°„ DM ìˆ˜ì‹ , ê²€ì¦, ì €ì¥, í‘¸ì‹œ ë‹´ë‹¹
        - `GET /api/chat/{roomId}`  
          â†’ íŠ¹ì • ë°©ì˜ ê³¼ê±° ë©”ì‹œì§€ íˆìŠ¤í† ë¦¬ë¥¼ REST APIë¡œ ì œê³µ

---

#### ê´€ë ¨ ì†ŒìŠ¤ ì½”ë“œ

- [WebSocketConfig.java](backend/src/main/java/com/myfcseoul/backend/config/WebSocketConfig.java)
- [ChatController.java](backend/src/main/java/com/myfcseoul/backend/controller/ChatController.java)
- [ChatRoomController.java](backend/src/main/java/com/myfcseoul/backend/controller/ChatRoomController.java)
- [ChatService.java](backend/src/main/java/com/myfcseoul/backend/service/ChatService.java)
- [ChatRoomRepository.java](backend/src/main/java/com/myfcseoul/backend/repository/ChatRoomRepository.java)
- [ChatMessageRepository.java](backend/src/main/java/com/myfcseoul/backend/repository/ChatMessageRepository.java)

---

### 5-6. **ë‹¤ì´ì–´ë¦¬ ê¸°ëŠ¥**
<img width="750" height="296" alt="Image" src="https://github.com/user-attachments/assets/c80bd3fa-5281-4071-90a8-a0c018fd8b9d" />
<br>
ê²½ê¸° ì§ê´€ í›„ ëŠë‚€ ì ê³¼ ì‚¬ì§„ì„ ë‹¤ì´ì–´ë¦¬ í˜•íƒœë¡œ ê¸°ë¡í•˜ê³ <br>
ë‹¤ë¥¸ FCì„œìš¸ íŒ¬ë“¤ì˜ ì§ê´€ ê¸°ë¡ë„ í•¨ê»˜ êµ¬ê²½í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.

#### API ì„¤ê³„

1. **ë‹¤ì´ì–´ë¦¬ ìƒì„± â€“ `POST /api/gallery`**
   - Request Body (JSON)
     ```json
     {
       "userId": "4540681543",
       "title": "ìˆ˜ì›ì „ 3:0 ì™„ìŠ¹ ì§ê´€",
       "content": "ë¶„ìœ„ê¸° ë¯¸ì³¤ë‹¤â€¦",
       "imageUrl": "https://s3.../gallery/2025-04-01-xxxx.jpg",
       "createdAt": "2025-04-01T18:30:00"
     }
     ```
   - ì²˜ë¦¬ ê³¼ì •
     - `userId`ë¡œ `UserRepository.findById(...)` í˜¸ì¶œ â†’ ì‘ì„±ì `User` ì—”í‹°í‹° ì¡°íšŒ  
     - `CreateGalleryRequestDTO` ì˜ í•„ë“œë¥¼ ì´ìš©í•´ `Gallery` ì—”í‹°í‹° ìƒì„±  
       - `user`, `title`, `content`, `imageUrl`, `createdAt` ì„¸íŒ…  
     - `GalleryRepository.save(gallery)` ë¡œ DBì— ì €ì¥  
   - ì‘ë‹µ
     - ìƒì„±ëœ `Gallery` ì—”í‹°í‹°(JSON) + `201 CREATED`

2. **íŠ¹ì • ì‚¬ìš©ìì˜ ë‹¤ì´ì–´ë¦¬ ëª©ë¡ ì¡°íšŒ â€“ `GET /api/gallery/{userId}`**
   - ì²˜ë¦¬ ê³¼ì •
     - Path Variable `{userId}`ë¥¼ ì´ìš©í•´  
       `GalleryRepository.findByUserUserId(userId)` í˜¸ì¶œ  
     - í•´ë‹¹ ì‚¬ìš©ìì˜ ë‹¤ì´ì–´ë¦¬ ëª©ë¡ì„ ìµœì‹ ìˆœ ì •ë ¬ì€ í”„ë¡ íŠ¸ì—ì„œ ìˆ˜í–‰
   - ì‘ë‹µ
     - `Gallery` ë¦¬ìŠ¤íŠ¸(JSON)  
       - ê° í•­ëª©ì— `galleryId`, `title`, `content`, `imageUrl`, `createdAt`, `user` ì •ë³´ í¬í•¨  
       - í”„ë¡ íŠ¸ì—ì„œ `/diary/{userId}` í˜ì´ì§€ì— ê·¸ë¦¬ë“œ ì¹´ë“œ í˜•íƒœë¡œ ë Œë”ë§

3. **ë‹¤ì´ì–´ë¦¬ ìˆ˜ì • â€“ `PUT /api/gallery/{galleryId}`**
   - Request Body (JSON)
     ```json
     {
       "title": "ìˆ˜ì›ì „ 3:0 ì™„ìŠ¹ ì§ê´€ (ì‚¬ì§„ ì—…ë°ì´íŠ¸)",
       "content": "í›„ë°˜ ë¶„ìœ„ê¸° ì¶”ê°€ ê¸°ë¡...",
       "imageUrl": "https://s3.../gallery/2025-04-01-updated.jpg",
       "createdAt": "2025-04-01T18:30:00"
     }
     ```
   - ì²˜ë¦¬ ê³¼ì •
     - `galleryId`ë¡œ `GalleryRepository.findById(...)` í˜¸ì¶œ â†’ ê¸°ì¡´ ë‹¤ì´ì–´ë¦¬ ì¡°íšŒ  
     - ì‘ì„±ì `user`ëŠ” ë³€ê²½í•˜ì§€ ì•Šê³ ,  
       `title`, `content`, `imageUrl`, `createdAt` í•„ë“œë§Œ ì—…ë°ì´íŠ¸  
     - `GalleryRepository.save(existing)` ë¡œ ìˆ˜ì • ë‚´ìš© ì €ì¥
   - ì‘ë‹µ
     - ìˆ˜ì •ëœ `Gallery` ì—”í‹°í‹°(JSON)

4. **ë‹¤ì´ì–´ë¦¬ ì‚­ì œ â€“ `DELETE /api/gallery/{galleryId}`**
   - ì²˜ë¦¬ ê³¼ì •
     - `GalleryRepository.deleteById(galleryId)` í˜¸ì¶œë¡œ í•´ë‹¹ ë‹¤ì´ì–´ë¦¬ ì‚­ì œ
   - ì‘ë‹µ
     - `204 No Content`

#### ê´€ë ¨ ì†ŒìŠ¤ ì½”ë“œ

- [Gallery.java](backend/src/main/java/com/myfcseoul/backend/model/Gallery.java)
- [GalleryRepository.java](backend/src/main/java/com/myfcseoul/backend/repository/GalleryRepository.java)
- [GalleryController.java](backend/src/main/java/com/myfcseoul/backend/controller/GalleryController.java)
- [CreateGalleryRequestDTO.java](backend/src/main/java/com/myfcseoul/backend/dto/CreateGalleryRequestDTO.java)
  
---

<br>

<a id="sec-6-trouble"></a>
## 6. âš ï¸ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### 6-1. EC2 1GB RAM í™˜ê²½ì—ì„œ ë©”ëª¨ë¦¬ ë¶€ì¡±ìœ¼ë¡œ ì¸í•œ ì„œë²„ ë‹¤ìš´ & Swap ë„ì…

1. **ìƒí™©**
  <img width="1010" height="297" alt="Image" src="https://github.com/user-attachments/assets/dd47e9a4-0a39-4387-b264-f4e282354eef" />
    <br>
    - AWS EC2 í”„ë¦¬í‹°ì–´ ìˆ˜ì¤€ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í–ˆëŠ”ë°, ì œê³µë˜ëŠ” RAM ì´ **1GBë¿ì¸ í™˜ê²½**ì—ì„œ
      í•´ë‹¹ í”„ë¡œì íŠ¸ë¥¼ ì˜¬ë ¤ë‘ê³  ìš´ì˜í•˜ê³  ìˆì—ˆìŒ
    - ì¼ì • ì‹œê°„ì´ ì§€ë‚˜ë©´ ì‚¬ì´íŠ¸ ì ‘ì†ì´ ëŠë ¤ì§€ë‹¤ê°€ ê²°êµ­ ì„œë²„ê°€ ì‘ë‹µí•˜ì§€ ì•Šê³  ì ‘ì†ì´ ëŠê¸°ëŠ” í˜„ìƒì´ ë°˜ë³µì ìœ¼ë¡œ ë°œìƒ

2. **ë¬¸ì œ**
    - ì„œë²„ ëª¨ë‹ˆí„°ë§ ê²°ê³¼:
        - RAM ì‚¬ìš©ë¥ ì€ ì´ë¯¸ 100%ì— ê°€ê¹Œìš´ ìƒíƒœë¡œ **ìƒì‹œ í¬í™”**
        - CPU ì‚¬ìš©ë¥  ë˜í•œ **100%ê¹Œì§€ ì¹˜ì†Ÿì€ ë’¤ ì‹œìŠ¤í…œì´ ì‚¬ì‹¤ìƒ ë©ˆì¶°ë²„ë¦¬ëŠ”** í˜„ìƒ ë°œìƒ
    - ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ ìƒì—ì„œëŠ” íŠ¹ë³„í•œ ì˜ˆì™¸ê°€ ë³´ì´ì§€ ì•Šì•˜ì§€ë§Œ SSH ì ‘ì†ê¹Œì§€ ëŠë ¤ì§ˆ ì •ë„ë¡œ ì„œë²„ ì „ì²´ê°€ ë²„ë²…ì´ëŠ” ìƒíƒœê°€ ë¨

3. **ì›ì¸ ë¶„ì„**
  1. ì¸ìŠ¤í„´ìŠ¤ ìì²´ì˜ **ë¬¼ë¦¬ ë©”ëª¨ë¦¬(RAM)ê°€ 1GBë¡œ ë§¤ìš° ì‘ìŒ**
  2. Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ + ê¸°íƒ€ í”„ë¡œì„¸ìŠ¤ë¥¼ ë™ì‹œì— êµ¬ë™í•˜ë©´ì„œ ê°€ìš© ë©”ëª¨ë¦¬ê°€ ê±°ì˜ ë‚¨ì§€ ì•ŠëŠ” ìƒíƒœê°€ ì§€ì†ë¨
  3. RAM ì´ ë¶€ì¡±í•´ì§€ë©´ OSëŠ” ë©”ëª¨ë¦¬ í™•ë³´ë¥¼ ìœ„í•´ í˜ì´ì§€ë¥¼ ê³„ì† ì •ë¦¬/êµì²´í•˜ë ¤ê³  ì‹œë„í•˜ê²Œ ë˜ê³ , ì´ ê³¼ì •ì—ì„œ **Context SwitchingÂ·ë©”ëª¨ë¦¬ ê´€ë¦¬ ì˜¤ë²„í—¤ë“œê°€ ê¸‰ê²©íˆ ì¦ê°€**í•˜ë©´ì„œ CPU ì‚¬ìš©ë¥ ë„ ê°™ì´ íŠ€ê²Œ ë¨
  4. ê²°êµ­:
      - ìƒˆë¡œ ë©”ëª¨ë¦¬ë¥¼ í• ë‹¹ë°›ì§€ ëª»í•œ í”„ë¡œì„¸ìŠ¤ê°€ ë¹„ì •ìƒ ë™ì‘í•˜ê±°ë‚˜
      - OOM(Out Of Memory) ìƒí™©ìœ¼ë¡œ í”„ë¡œì„¸ìŠ¤/ì„œë¹„ìŠ¤ê°€ ë‚´ë ¤ê°€ë©´ì„œ
        â€œì„œë²„ê°€ ë‹¤ìš´ëœ ê²ƒì²˜ëŸ¼ ë³´ì´ëŠ”â€ í˜„ìƒì´ ë°˜ë³µë˜ì—ˆìŒ

4. **í•´ê²° ë°©ë²• â€“ Swap íŒŒì¼ ë„ì…**
  > *Swap: ì‹œìŠ¤í…œ ë©”ëª¨ë¦¬(RAM)ê°€ ë¶€ì¡±í•  ë•Œ ë””ìŠ¤í¬ì˜ ì¼ë¶€ë¥¼ ì„ì‹œ ë©”ëª¨ë¦¬ì²˜ëŸ¼ ì‚¬ìš©í•˜ëŠ” ê¸°ëŠ¥*

  1. **2GB í¬ê¸°ì˜ Swap íŒŒì¼ ìƒì„±**
     ```bash
     dd if=/dev/zero of=/root/swapfile bs=1k count=2000000 conv=excl
     ```
  2. **ê¶Œí•œ ì„¤ì • (ë³´ì•ˆìƒ rootë§Œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ì œí•œ)**
     ```bash
     chmod 600 /root/swapfile
     ```
  3. **ìŠ¤ì™‘ ì˜ì—­ ì´ˆê¸°í™”**
     ```bash
     mkswap /root/swapfile
     ```
  4. **Swap í™œì„±í™”**
     ```bash
     swapon /root/swapfile
     ```
  5. **ë¶€íŒ… ì‹œ ìë™ í™œì„±í™” ì„¤ì • (`/etc/fstab` ë“±ë¡)**
     ```bash
     /root/swapfile  swap  swap  defaults  0  0
     ```
  - ìš”ì•½í•˜ë©´:  
    **ìŠ¤ì™‘ íŒŒì¼ ìƒì„± â†’ ê¶Œí•œ ì„¤ì • â†’ ìŠ¤ì™‘ ì´ˆê¸°í™” â†’ ìŠ¤ì™‘ í™œì„±í™” â†’ ë¶€íŒ… ì‹œ ìë™ í™œì„±í™”** ìˆœì„œë¡œ ì‘ì—…ì„ ì§„í–‰í•¨

5. **ê²°ê³¼**
  <img width="1246" height="272" alt="Image" src="https://github.com/user-attachments/assets/14b7e738-7781-4677-a4d9-b569e8585cdb" />
  <br>
  - `free -h` ëª…ë ¹ì„ í†µí•´ **2GB í¬ê¸°ì˜ Swap ê³µê°„ì´ ì •ìƒì ìœ¼ë¡œ ì¡íŒ ê²ƒ**ì„ í™•ì¸
    - ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í•´ì§€ëŠ” êµ¬ê°„ì—ì„œë„:
        - ê¸°ì¡´ì—ëŠ” CPU ì‚¬ìš©ë¥ ì´ 100%ê¹Œì§€ ì¹˜ì†Ÿê³  ì„œë²„ê°€ ë©ˆì·„ë‹¤ë©´,
        - Swap ì ìš© í›„ì—ëŠ” ë””ìŠ¤í¬ë¥¼ í†µí•´ ì—¬ìœ  ë©”ëª¨ë¦¬ ê³µê°„ì´ í™•ë³´ë˜ë©´ì„œ
          **CPU ì‚¬ìš©ë¥ ë„ ì•½ 100% â†’ 10%ëŒ€ ìˆ˜ì¤€ìœ¼ë¡œ ì•ˆì •ì ìœ¼ë¡œ ë–¨ì–´ì§€ëŠ” ê²ƒ**ì„ í™•ì¸
    - ì„œë²„ê°€ ì¥ì‹œê°„ ë–  ìˆì–´ë„ ì´ì „ì²˜ëŸ¼ ì‰½ê²Œ ë‹¤ìš´ë˜ì§€ ì•Šê³ ,
      ì„œë¹„ìŠ¤ ì‘ë‹µ ì†ë„ë„ ì•ˆì •ì ìœ¼ë¡œ ìœ ì§€ë˜ëŠ” ê²ƒì„ í™•ì¸í•¨

6. **ëŠë‚€ì **
    - í”„ë¦¬í‹°ì–´/ì €ì‚¬ì–‘ ì¸ìŠ¤í„´ìŠ¤ì²˜ëŸ¼ **RAM ì´ ì‘ì€ í™˜ê²½ì—ì„œ ì—¬ëŸ¬ ì„œë¹„ìŠ¤ë¥¼ ë™ì‹œì— ì˜¬ë¦¬ë©´**  
      CPU ë¬¸ì œì²˜ëŸ¼ ë³´ì—¬ë„ ì‹¤ì œ ê·¼ë³¸ ì›ì¸ì€ **ë©”ëª¨ë¦¬ ë¶€ì¡±**ì¸ ê²½ìš°ê°€ ë§ë‹¤ëŠ” ê²ƒì„ ì²´ê°í–ˆë‹¤.
    - ìš´ì˜ í™˜ê²½ì—ì„œ ì¥ì• ê°€ ë°œìƒí–ˆì„ ë•ŒëŠ”,
      ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ë§Œ ë³´ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ **CPUÂ·ë©”ëª¨ë¦¬Â·Swap ì‚¬ìš©ëŸ‰ ë“± ì‹œìŠ¤í…œ ë¦¬ì†ŒìŠ¤**ë¥¼ í•¨ê»˜ ë³´ëŠ” ìŠµê´€ì´ ì¤‘ìš”í•˜ë‹¤ëŠ” ê²ƒì„ ê¹¨ë‹¬ì•˜ë‹¤.
    - ì¥ê¸°ì ìœ¼ë¡œëŠ” ì¸ìŠ¤í„´ìŠ¤ ìŠ¤í™ ì—…ê·¸ë ˆì´ë“œë‚˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ê²½ëŸ‰í™”ê°€ ì •ì„ì´ì§€ë§Œ,  
      ê·¸ ì „ ë‹¨ê³„ì—ì„œ **Swap ì„¤ì •ë§Œìœ¼ë¡œë„ ì €ë¹„ìš©ìœ¼ë¡œ ì•ˆì •ì„±ì„ í¬ê²Œ ê°œì„ **í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì„ ê²½í—˜í•˜ê²Œ ë˜ì—ˆë‹¤.

<br>
---

### 6-2. WebSocket 1:1 ì±„íŒ… â€“ ë°°í¬ í™˜ê²½ì—ì„œë§Œ ë©”ì‹œì§€ê°€ ìˆ˜ì‹ ë˜ì§€ ì•Šë˜ ë¬¸ì œ

- **ìƒí™©**
    - ë¡œì»¬ í™˜ê²½ì—ì„œëŠ” WebSocket ì—°ê²° ë° ë©”ì‹œì§€ ì†¡ìˆ˜ì‹ ì´ ì •ìƒ ë™ì‘í–ˆì§€ë§Œ
      EC2 + Nginx ë°°í¬ í™˜ê²½ì—ì„œëŠ” ì±„íŒ… ë©”ì‹œì§€ê°€ ìƒëŒ€ë°© í™”ë©´ì— ë³´ì´ì§€ ì•ŠëŠ” ë¬¸ì œ ë°œìƒ

- **ë¬¸ì œ**
    - í´ë¼ì´ì–¸íŠ¸ì—ì„œëŠ” STOMP ì—°ê²°ì´ ëœ ê²ƒì²˜ëŸ¼ ë³´ì´ê³ , SEND í”„ë ˆì„ë„ ì „ì†¡ë˜ì§€ë§Œ
      ìƒëŒ€ë°© í™”ë©´ì— ë©”ì‹œì§€ê°€ í‘œì‹œë˜ì§€ ì•Šì•˜ìŒ
    - ì²˜ìŒì—ëŠ” ChatController ë° JPA ë¬¸ì œë¼ê³  íŒë‹¨

- **ì›ì¸ ë¶„ì„**
    1. ì„œë²„ ë¡œê·¸ì™€ SQL ë¡œê·¸ë¥¼ í†µí•´ WebSocket í•¸ë“¤ëŸ¬ ì§„ì…ê³¼ DB INSERTê°€ **ì •ìƒì ìœ¼ë¡œ ìˆ˜í–‰**ë˜ê³  ìˆìŒì„ í™•ì¸í–ˆë‹¤.
        - `[WS-IN]`, `[ROOM]`, `[DB-SAVE-OK]` ë¡œê·¸ì™€ Hibernate SQL ë¡œê·¸ë¡œ ê²€ì¦
    2. DBì—ëŠ” ë©”ì‹œì§€ê°€ ì €ì¥ë˜ëŠ”ë°ë„ í´ë¼ì´ì–¸íŠ¸ê°€ ë©”ì‹œì§€ë¥¼ ë°›ì§€ ëª»í•˜ëŠ” ì ì„ í†µí•´ **ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§ë³´ë‹¤ WebSocket í”„ë¡ì‹œ, ì„¸ì…˜ ìª½ ë¬¸ì œ**ë¡œ ë²”ìœ„ë¥¼ ì¢í˜
    3. Nginxì—ì„œ `/ws-chat` ê²½ë¡œì— ëŒ€í•œ WebSocket í”„ë¡ì‹œ ì„¤ì •ì´ ë¶ˆì™„ì „í–ˆê³ 
       `Cookie` ë° `X-Forwarded-*` í—¤ë”ë¥¼ ì „ë‹¬í•˜ì§€ ì•Šì•„ ì„¸ì…˜ ê¸°ë°˜ ì‚¬ìš©ì ì‹ë³„ì´ ì œëŒ€ë¡œ ë˜ì§€ ì•Šê³  ìˆìŒ
    4. Spring Security ì„¤ì •ì—ì„œë„ `/ws-chat/**` ê²½ë¡œê°€ ëª…ì‹œì ìœ¼ë¡œ í—ˆìš©ë˜ì§€ ì•Šì•„
       ë°°í¬ í™˜ê²½ì—ì„œ WebSocket í•¸ë“œì…°ì´í¬ê°€ ê°„í—ì ìœ¼ë¡œ ì‹¤íŒ¨í•˜ëŠ” ê²ƒì´ ì›ì¸

- **í•´ê²° ë°©ë²•**
    - Nginx ì„¤ì •ì„ ë‹¤ìŒê³¼ ê°™ì´ ì •ë¦¬
        - WebSocketì€ ì¼ë°˜ HTTPì™€ ë‹¤ë¥´ê²Œ ì—°ê²° ë°©ì‹ì¸ (Upgrade , Connection í—¤ë”) + ì¿ í‚¤(ë¡œê·¸ì¸ ì •ë³´) ì œëŒ€ë¡œ ë„˜ê²¨ì¤˜ì•¼í•¨
        - ë”°ë¼ì„œ `map $http_upgrade` ë¡œ ì›¹ì†Œì¼“ì´ë©´ upgrade ì²˜ë¦¬ í›„ Cookie ì™€ X-Forwarded ë“±ì„ ë°±ì—”ë“œ ì¦‰, ì„œë²„ë¡œ ê°™ì´ ë³´ë‚´ì¤Œ
    - Spring Securityì—ì„œ `/ws-chat/**` ê²½ë¡œë¥¼ `permitAll()` ë¡œ í—ˆìš©í•˜ì—¬
      WebSocket í•¸ë“œì…°ì´í¬ê°€ ì¸ì¦ í•„í„°ì—ì„œ ì°¨ë‹¨ë˜ì§€ ì•Šë„ë¡ í•¨
    - ì´í›„ ë°°í¬ í™˜ê²½ì—ì„œë„ ë¡œì»¬ê³¼ ë™ì¼í•˜ê²Œ 1:1 ì±„íŒ…ì´ ì •ìƒ ë™ì‘í•˜ëŠ” ê²ƒì„ í™•ì¸

- **ëŠë‚€ì **
    - ì´ˆë°˜ì—ëŠ” ë°±ì—”ë“œë‚˜ í”„ë¡ íŠ¸ì—”ë“œ ì½”ë“œ ë¬¸ì œë¼ê³  ìƒê°í–ˆì§€ë§Œ ì‹¤ì œ ì›ì¸ì€ ë°°í¬ ê³¼ì •ì—ì„œ í”„ë¡ì‹œ ì—­í• ì„ í•˜ë„ë¡ ì¶”ê°€í•œ `Nginx` ì„¤ì •ì— ìˆì—ˆë‹¤. ë¡œì»¬ì—ì„œëŠ” ì •ìƒ ë™ì‘í•˜ì§€ë§Œ ë°°í¬ í™˜ê²½ì—ì„œë§Œ ë¬¸ì œê°€ ë°œìƒí•œë‹¤ë©´, ì•ìœ¼ë¡œëŠ” ì—”ë“œí¬ì¸íŠ¸ë‚˜ í”„ë¡ì‹œ ì„¤ì •ë¶€í„° ìš°ì„ ì ìœ¼ë¡œ ì ê²€í•´ì•¼ê² ë‹¤ê³  ëŠê¼ˆë‹¤.
  
<br>
---

### 6-3. S3 Presigned URLì„ ì´ìš©í•œ ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹¤íŒ¨ ë¬¸ì œ

- **ìƒí™©**
    - ì§ê´€ ì¸ì¦ìš© ì‚¬ì§„ì„ AWS S3ì— ì§ì ‘ ì—…ë¡œë“œí•˜ê¸° ìœ„í•´ ë°±ì—”ë“œì—ì„œ Presigned PUT URLì„ ë°œê¸‰í•˜ê³ 
      í”„ë¡ íŠ¸ì—”ë“œ(React)ì—ì„œ í•´ë‹¹ URLë¡œ `fetch(â€¦, { method: "PUT" })` ìš”ì²­ì„ ë³´ë‚´ëŠ” êµ¬ì¡°ë¡œ êµ¬í˜„
    - ë¡œì»¬ì—ì„œëŠ” í¬ê²Œ ë¬¸ì œ ì—†ì´ ë™ì‘í•˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì˜€ì§€ë§Œ ì‹¤ì œ ì—…ë¡œë“œ ê³¼ì •ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•´
      íŒŒì¼ì´ S3ì— ì €ì¥ë˜ì§€ ì•ŠëŠ” ë¬¸ì œ ë°œìƒ

- **ë¬¸ì œ**
    - `/api/s3/upload-url/attendance` ë¡œ Presigned URLì„ ë°›ì€ ë’¤
      í•´ë‹¹ URLë¡œ PUT ìš”ì²­ì„ ë³´ë‚´ë©´ `"Upload to S3 failed"` ì—ëŸ¬ê°€ ë°œìƒ
    - ì½˜ì†” ìƒì—ì„œëŠ” ìš”ì²­ì´ ë‚˜ê°€ì§€ë§Œ, S3 ë²„í‚·ì— ì‹¤ì œ íŒŒì¼ì´ ìƒì„±ë˜ì§€ ì•ŠìŒ

- **ì›ì¸ ë¶„ì„**
    1. ë¬¸ì œë¥¼ ì¶”ì í•˜ê¸° ìœ„í•´ Presigned URL ìƒì„± ë¡œì§ê³¼ í”„ë¡ íŠ¸ ì—…ë¡œë“œ ì½”ë“œë¥¼ ë‹¤ì‹œ í™•ì¸<br>
    2. ì¤‘ê°„ì— ì—…ë¡œë“œ íŒŒì¼ì˜ `Content-Type`ì„ ë” ëª…í™•íˆ í•˜ë ¤ê³ 
       Presigned URL ìƒì„± ì‹œ `contentType`ì„ í¬í•¨ì‹œí‚¤ê³  í”„ë¡ íŠ¸ì—ì„œë„ `Content-Type` í—¤ë”ë¥¼ í•¨ê»˜ ë³´ë‚´ëŠ” ë°©ì‹ìœ¼ë¡œ ìˆ˜ì •<br>
    3. í•˜ì§€ë§Œ Presigned URLì— `contentType`ì´ ì„œëª…ê°’ìœ¼ë¡œ í¬í•¨ë˜ë©´,
       **PUT ìš”ì²­ ì‹œì˜ `Content-Type` í—¤ë”ê°€ ì„œëª…ì— ì‚¬ìš©ëœ ê°’ê³¼ ì™„ì „íˆ ì¼ì¹˜í•´ì•¼ë§Œ** ì—…ë¡œë“œê°€ ì„±ê³µ<br>
    4. ë¸Œë¼ìš°ì €/í™˜ê²½ì— ë”°ë¼ `Content-Type` ë¬¸ìì—´ì´ ë¯¸ë¬˜í•˜ê²Œ ë‹¬ë¼ì§€ê±°ë‚˜,
       ì¸ì½”ë”©/ì „ë‹¬ ê³¼ì •ì—ì„œ ê°’ì´ ì–´ê¸‹ë‚˜ë©´ì„œ **S3ì—ì„œ ì„œëª… ë¶ˆì¼ì¹˜(403)ë¡œ ì—…ë¡œë“œë¥¼ ê±°ë¶€** ë°œìƒ<br>

- **í•´ê²° ë°©ë²•**
    - Presigned URL ìƒì„± ì‹œ ì„œëª…ì— í¬í•¨ë˜ëŠ” ì •ë³´ë¥¼ ë‹¨ìˆœí™” í•˜ê¸°
        - `bucket`ê³¼ `key`ë§Œìœ¼ë¡œ Presigned URLì„ ìƒì„±í•˜ê³ 
          `contentType`ì€ ì„œëª… ëŒ€ìƒì—ì„œ ì œê±°
    - í”„ë¡ íŠ¸ì—”ë“œì—ì„œëŠ” íŒŒì¼ëª…ë§Œ ì„œë²„ì— ì „ë‹¬í•´ Presigned URLì„ ë°›ê³ 
      S3 PUT ìš”ì²­ ì‹œì—ëŠ” í•„ìš”ì— ë”°ë¼ `Content-Type` í—¤ë”ë§Œ ì¶”ê°€ë¡œ ë³´ë‚´ë„ë¡ ìˆ˜ì •
    - ì´í›„ì—ëŠ” ë¸Œë¼ìš°ì €ê°€ ë³´ë‚´ëŠ” `Content-Type` ê°’ì— ìƒê´€ì—†ì´ ì—…ë¡œë“œê°€ ì•ˆì •ì ìœ¼ë¡œ ì„±ê³µí•˜ëŠ” ê²ƒì„ í™•ì¸

- **ëŠë‚€ì **
    - S3 Presigned URLì„ ì‚¬ìš©í•  ë•ŒëŠ” **ì„œëª…ì— í¬í•¨ë˜ëŠ” í—¤ë”/íŒŒë¼ë¯¸í„°ê°€ ì•„ì£¼ ë¯¼ê°í•˜ê²Œ ë¹„êµ**ëœë‹¤ëŠ” ì ì„ ë°°ì› ë‹¤. íŠ¹íˆ `Content-Type`ì„ ì„œëª…ì— í¬í•¨ì‹œí‚¤ëŠ” ê²½ìš°ì—ëŠ” í´ë¼ì´ì–¸íŠ¸ì—ì„œ ë³´ë‚´ëŠ” í—¤ë”ì™€ í•œ ê¸€ìë¼ë„ ë‹¤ë¥´ë©´ ì—…ë¡œë“œê°€ ì‹¤íŒ¨í•˜ë¯€ë¡œ
      ì´ˆê¸°ì—ëŠ” ì„œëª… ëŒ€ìƒì„ ìµœì†Œí™”í•˜ê³  í•„ìš”í•œ ê²½ìš°ì—ë§Œ ì ì§„ì ìœ¼ë¡œ í™•ì¥í•˜ëŠ” ì „ëµì´ ë” ì•ˆì „í•˜ë‹¤ê³  ëŠê¼ˆë‹¤.
<br>
---

### 6-4. ë‹‰ë„¤ì„ ë¯¸ì œê³µ(Unknown)ìœ¼ë¡œ ì¸í•œ ìŠ¹ë¥ /ë­í‚¹ ë°ì´í„° ì™œê³¡ ë¬¸ì œ

- **ìƒí™©**
    - ì¹´ì¹´ì˜¤ ì†Œì…œ ë¡œê·¸ì¸ì„ ì‚¬ìš©í•˜ë©´ì„œ ì‚¬ìš©ìê°€ ì¹´ì¹´ì˜¤ ì¸¡ì— â€œë‹‰ë„¤ì„ ì œê³µâ€ì„ í—ˆìš©í•˜ì§€ ì•Šìœ¼ë©´
      ìš°ë¦¬ ì„œë¹„ìŠ¤ ìª½ì—ëŠ” ë‹‰ë„¤ì„ ì •ë³´ê°€ ì˜¤ì§€ ì•ŠìŒ
    - ì´ëŸ° ì‚¬ìš©ìë“¤ì€ DBì— ê³µí†µëœ ê¸°ë³¸ ë‹‰ë„¤ì„ `"Unknown"`ìœ¼ë¡œ ì €ì¥ë¨
    - ë­í‚¹(ì§ê´€ì™•, ì‘ì› ìš”ì •, ìŠ¹ë¦¬ìš”ì •)ê³¼ ìŠ¹ë¥  í†µê³„ëŠ” `User.nickname` ê¸°ì¤€ìœ¼ë¡œ ê·¸ë£¹í™”í•˜ê³  ìˆì—ˆê³  í™”ë©´ì—ë„ â€œë‹‰ë„¤ì„â€ì„ ê¸°ì¤€ìœ¼ë¡œ ìˆœìœ„ë¥¼ ë³´ì—¬ì£¼ê³  ìˆì—ˆìŒ

- **ë¬¸ì œ**
    - ì‹¤ì œë¡œëŠ” ì„œë¡œ ë‹¤ë¥¸ ì—¬ëŸ¬ ì‚¬ìš©ìì¸ë°, ë‹‰ë„¤ì„ì´ ëª¨ë‘ `"Unknown"` ìœ¼ë¡œ ë™ì¼í•˜ê²Œ ë“¤ì–´ê°€ë©´ì„œ ë­í‚¹ ì¿¼ë¦¬ì—ì„œ ì´ ì‚¬ìš©ìë“¤ì´ **í•˜ë‚˜ì˜ ë‹‰ë„¤ì„ìœ¼ë¡œ í•©ì³ì ¸ ì§‘ê³„**ë˜ì—ˆë‹¤.
    - ìš´ì˜ ì¤‘ ë­í‚¹ í˜ì´ì§€ë¥¼ í™•ì¸í–ˆì„ ë•Œ
        - ì‹¤ì œë¡œëŠ” ì§ê´€ì„ ë§ì´ ë‹¤ë‹ˆì§€ ì•Šì€ ìœ ì €ì¸ë° `"Unknown"` ì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ **TOP ìŠ¹ë¥ /ì¶œì„ ë­í‚¹ì— ëœ¨ëŠ”** ë¬¸ì œê°€ ë°œê²¬

- **ì›ì¸ ë¶„ì„**
    1. `User` ì—”í‹°í‹°ì—ì„œ `nickname` ì»¬ëŸ¼ì— ìœ ë‹ˆí¬ ì œì•½ì´ ì—†ì—ˆê³  ì¹´ì¹´ì˜¤ì—ì„œ ë‹‰ë„¤ì„ì„ ì œê³µí•˜ì§€ ì•ŠëŠ” ì‚¬ìš©ìëŠ” ë™ì¼í•œ ê¸°ë³¸ ë¬¸ìì—´ë¡œ ì €ì¥ë˜ì–´ ìˆìŒ
    2. ë­í‚¹ ì¿¼ë¦¬ì—ì„œ ê¸°ì¤€ ì»¬ëŸ¼ì„ `userId` ê°€ ì•„ë‹Œ `u.nickname` ìœ¼ë¡œ ê·¸ë£¹í™”í•˜ê³  ìˆì—ˆê¸° ë•Œë¬¸ì—,
       **ê°™ì€ ë‹‰ë„¤ì„ì„ ê°€ì§„ ì—¬ëŸ¬ ì‚¬ìš©ìì˜ ë°ì´í„°ê°€ í•œ ì‚¬ëŒì˜ ê²ƒì²˜ëŸ¼ í•©ì‚°**
       ```java
       @Query("""
           SELECT u.nickname AS nickname,
                  COUNT(md)    AS attendanceCount
             FROM MyData md
             JOIN md.user u
            WHERE md.attended = 1
            GROUP BY u.nickname
            ORDER BY COUNT(md) DESC
       """)
       List<AttendanceRankDTO> findTopAttendance(Pageable pageable);
       ```
    3. ì´ë¡œ ì¸í•´, ì‹¤ì œ ìœ ì €ì˜ ì§ê´€/ìŠ¹ë¥ ê³¼ ìƒê´€ì—†ì´ `"Unknown"` ê³¼ ê°™ì€ ê¸°ë³¸ ë‹‰ë„¤ì„ì´ **ë­í‚¹ ë°ì´í„° ì „ì²´ë¥¼ ì™œê³¡**í•˜ëŠ” ë¬¸ì œê°€ ì§€ì†ì ìœ¼ë¡œ ë°œìƒ
    4. ë˜í•œ, ì‚¬ìš©ìê°€ ì§ì ‘ ë‹‰ë„¤ì„ì„ ë°”ê¾¸ê³  ì‹¶ì–´ë„
        - ì¤‘ë³µ ì²´í¬ê°€ ì¶©ë¶„íˆ ë˜ì–´ ìˆì§€ ì•Šì•˜ê³ 
        - ì—ëŸ¬ ë©”ì‹œì§€ë„ ì¼ê´€ë˜ì§€ ì•Šì•„ UX ì¸¡ë©´ì—ì„œë„ ë¶ˆí¸í•¨ì´ ìˆì—ˆìŒ

- **í•´ê²° ë°©ë²•**
    - **DB/ì—”í‹°í‹° ë ˆë²¨**
        - `User` ì—”í‹°í‹°ì˜ ë‹‰ë„¤ì„ ì»¬ëŸ¼ì— ìœ ë‹ˆí¬ ì œì•½ì„ ì¶”ê°€
          ```java
          // ë‹‰ë„¤ì„ ì»¬ëŸ¼ ì´ë¦„ì„ IDnicknameìœ¼ë¡œ ì„¤ì •í•˜ê³  ê³ ìœ  ì œì•½ ì¶”ê°€
          @Column(name = "IDnickname", nullable = false, unique = true)
          private String nickname;
          ```
        - ì´ë ‡ê²Œ í•¨ìœ¼ë¡œì¨, **ì„œë¡œ ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ê°™ì€ ë‹‰ë„¤ì„ì„ ê°€ì§€ì§€ ëª»í•˜ë„ë¡** ìˆ˜ì •
    - **Repository ë ˆë²¨ â€“ ì¤‘ë³µ ë‹‰ë„¤ì„ ê²€ì‚¬**
        - ë³¸ì¸ ì™¸ì˜ ë‹¤ë¥¸ ì‚¬ìš©ìê°€ ê°™ì€ ë‹‰ë„¤ì„ì„ ì‚¬ìš© ì¤‘ì¸ì§€ í™•ì¸í•˜ëŠ” ë©”ì„œë“œë¥¼ ì¶”ê°€
          ```java
          // ë‹‰ë„¤ì„ ì¤‘ë³µ ì²´í¬ (ë³¸ì¸ ì œì™¸)
          boolean existsByNicknameAndUserIdNot(String nickname, String userId);
          ```
        - ë‹‰ë„¤ì„ ë³€ê²½ ì‹œ ì´ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´,
          ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ë‹‰ë„¤ì„ì— ëŒ€í•´ì„œëŠ” ë³€ê²½ì„ ë§‰ê³  ì—ëŸ¬ë¥¼ ë°˜í™˜
    - **í”„ë¡œí•„ API(ProfileController) ìˆ˜ì •**
        - ë‹‰ë„¤ì„ ë³€ê²½ APIì— **1ì£¼ì¼ 1íšŒ ì œí•œ + ì¤‘ë³µ ë‹‰ë„¤ì„ ê²€ì‚¬**ë¥¼ ëª¨ë‘ í¬í•¨
          ```java
          // 2) 1ì£¼ì¼ ì œí•œ ê²€ì‚¬
          if (last != null && last.isAfter(LocalDateTime.now().minusWeeks(1))) {
              return ResponseEntity
                      .badRequest()
                      .body("ì¼ì£¼ì¼ì— í•œ ë²ˆë§Œ ë‹‰ë„¤ì„ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
          }
    
          // 3) ì¤‘ë³µ ë‹‰ë„¤ì„ ê²€ì‚¬
          String newNick = req.getNickname().trim();
          if (userRepository.existsByNicknameAndUserIdNot(newNick, userId)) {
              return ResponseEntity
                      .badRequest()
                      .body("ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ë‹‰ë„¤ì„ì…ë‹ˆë‹¤.");
          }
    
          // 4) ì—…ë°ì´íŠ¸ ì‹¤í–‰
          LocalDateTime now = LocalDateTime.now();
          userRepository.updateNicknameOnly(userId, newNick, now);
          ```
        - ë³€ê²½ í›„ì—ëŠ” ë‹¤ì‹œ ìœ ì €ë¥¼ ì¡°íšŒí•´ ìµœì‹  ì •ë³´ë¥¼ ë°˜í™˜í•˜ë„ë¡ ìˆ˜ì •
    - **í”„ë¡ íŠ¸(ProfileModal) UX ê°œì„ **
        - ë‹‰ë„¤ì„ ì…ë ¥ ì‹œ:
            - í•œê¸€/ì˜ë¬¸ë§Œ í—ˆìš©
            - ì˜ë¬¸ 0.5, í•œê¸€ 1 ê¸°ì¤€ìœ¼ë¡œ **ìµœëŒ€ 6ê¸€ì ì œí•œ**
        - ì„œë²„ì—ì„œ ë‚´ë ¤ì˜¨ ì—ëŸ¬ ë©”ì‹œì§€(`"ì¼ì£¼ì¼ì— í•œ ë²ˆë§Œ ë‹‰ë„¤ì„ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."`)ë¥¼ ê·¸ëŒ€ë¡œ ëª¨ë‹¬ì— í‘œì‹œí•˜ì—¬ ì™œ ì €ì¥ì´ ì•ˆ ë˜ëŠ”ì§€ ì‚¬ìš©ì ì…ì¥ì—ì„œ ëª…í™•í•˜ê²Œ ì•Œ ìˆ˜ ìˆë„ë¡ í•¨
        - ë‹‰ë„¤ì„ì´ ì—†ëŠ” ì‚¬ìš©ìë‚˜ `"Unknown"` ì¸ ì‚¬ìš©ìëŠ” ì²˜ìŒ ì´ìš© ì‹œ í”„ë¡œí•„ ìˆ˜ì • ëª¨ë‹¬ì„ í†µí•´ **ê³ ìœ í•œ ë‹‰ë„¤ì„ì„ ì„¤ì •**í•˜ë„ë¡ ìœ ë„í•˜ëŠ” íë¦„ì„ ë§Œë“¤ë„ë¡ ì¬ì„¤ê³„

- **ëŠë‚€ì **
- ì†Œì…œ ë¡œê·¸ì¸ê³¼ ê°™ì´ ì™¸ë¶€ì—ì„œ ê°€ì ¸ì˜¤ëŠ” í”„ë¡œí•„ ì •ë³´(ë‹‰ë„¤ì„, ì´ë©”ì¼ ë“±)ëŠ”  
  â€œí•­ìƒ ì œê³µëœë‹¤â€ëŠ” ì „ì œë¥¼ ë‘ë©´ ì•ˆ ë˜ê³  **ë¯¸ì œê³µ/ì¤‘ë³µ ì¼€ì´ìŠ¤ë¥¼ ë³„ë„ë¡œ ì„¤ê³„**í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì„ ë°°ì› ë‹¤.
    - í†µê³„/ë­í‚¹ ê³„ì‚°ì—ì„œ íŠ¹ì • í•„ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê·¸ë£¹í™”í•  ë•ŒëŠ”
      í•´ë‹¹ í•„ë“œê°€ **ì‹¤ì œë¡œ ìœ ë‹ˆí¬í•œ ì‹ë³„ì ì—­í• ì„ í•  ìˆ˜ ìˆëŠ”ì§€**, ê·¸ë¦¬ê³  ìš´ì˜ ì¤‘ì— ê°’ì´ ì–´ë–»ê²Œ ë“¤ì–´ì˜¬ì§€(ê¸°ë³¸ê°’, ë¯¸ì œê³µ ê°’, ì¤‘ë³µ ê°’ ë“±)ë¥¼ í•¨ê»˜ ê³ ë ¤í•´ì•¼ ë°ì´í„°ê°€ ì™œê³¡ë˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒë„ ì•Œê²Œ ë˜ì—ˆë‹¤.
    - ì•ìœ¼ë¡œëŠ” ì‚¬ìš©ìë¥¼ ì§‘ê³„í•˜ëŠ” ê²½ìš°ì—ëŠ” í•­ìƒ ìœ ë‹ˆí¬í•œ ì»¬ëŸ¼(ì˜ˆ: `userId`)ì„ ê¸°ì¤€ìœ¼ë¡œë§Œ ì§‘ê³„ë¥¼ í•˜ê³  ë‹‰ë„¤ì„ì€ í™”ë©´ì— ë³´ì—¬ì£¼ê¸° ìœ„í•œ ë ˆì´ë¸”ë¡œë§Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì•ˆì „í•˜ë‹¤ëŠ” ê²ƒì„ ë°°ì› ë‹¤.

<br>

---
