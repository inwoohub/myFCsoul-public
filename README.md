# myFCseoul âš½ ( ì¶•êµ¬ ì§ê´€ ì›¹ ì„œë¹„ìŠ¤ )
**í”„ë¡œì¶•êµ¬ ì§ê´€ ê¸°ë¡ & AI ìŠ¹ë¶€ ì˜ˆì¸¡ ì›¹ ì„œë¹„ìŠ¤** <br>
[**https://www.myfcseoul.com/**](https://www.myfcseoul.com/)

> ì§ê´€ ê¸°ë¡ì„ ê´€ë¦¬í•˜ê³  AIë¥¼ í™œìš©í•´ ë‹¤ìŒ ê²½ê¸° ê²°ê³¼ë¥¼ ì˜ˆì¸¡í•˜ëŠ” FCì„œìš¸ íŒ¬ ì „ìš© ì›¹ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.

---

## 0. ëª©ì°¨
> 1. í”„ë¡œì íŠ¸ ê°œìš”
> 2. ì‚¬ìš© ê¸°ìˆ 
> 3. ì•„í‚¤í…ì²˜
> 4. í™”ë©´ êµ¬ì„±
> 5. ì£¼ìš” ê¸°ëŠ¥ ì„¤ê³„
> 6. íŠ¸ëŸ¬ë¸” ìŠˆíŒ…

---

## 1. ğŸ‘¨â€ğŸ’» í”„ë¡œì íŠ¸ ê°œìš”

- í”„ë¡œì íŠ¸ëª…: myFCseoul
- ê°œë°œ ê¸°ê°„: 2025.04 ~ 2025.10 (ì•½ 6ê°œì›”)
- ì¸ì›: 1ì¸ ê°œë°œ



### 1-1. ê°œë°œ ëª©ì 

- í”„ë¡œì¶•êµ¬íŒ€ì„ ì‘ì›í•˜ëŸ¬ ê°€ëŠ” FCì„œìš¸ íŒ¬ë“¤ì´
    - ìì‹ ì˜ ì§ê´€ ê¸°ë¡(ì–¸ì œ, ì–´ë–¤ ê²½ê¸°) ì„ ë‚¨ê¸°ê³ 
    - ë‚˜ì™€ íŒ€ì˜ ìŠ¹ë¥ ì„ ë¹„êµí•˜ê³ 
    - AIë¡œ ë‹¤ìŒ ê²½ê¸° ê²°ê³¼ë¥¼ ì˜ˆì¸¡í•´ë³´ëŠ” ì¬ë¯¸ë¥¼ ì œê³µí•˜ëŠ” ì›¹ ì„œë¹„ìŠ¤

<br>

## 2. âš’ï¸ ì‚¬ìš© ê¸°ìˆ 

### 2-1. Backend
<img src="https://img.shields.io/badge/java-007396?style=for-the-badge&logo=OpenJDK&logoColor=white"> <img src="https://img.shields.io/badge/Spring-6DB33F?style=for-the-badge&logo=Spring&logoColor=white"> <img src="https://img.shields.io/badge/springboot-6DB33F?style=for-the-badge&logo=springboot&logoColor=white"> <img src="https://img.shields.io/badge/MySQL-4479A1?style=for-the-badge&logo=MySQL&logoColor=white"> <img src="https://img.shields.io/badge/Hibernate-59666C?style=for-the-badge&logo=Hibernate&logoColor=white"> <img src="https://img.shields.io/badge/chatGPT-74aa9c?style=for-the-badge&logo=openai&logoColor=white"> <img src="https://img.shields.io/badge/-selenium-%43B02A?style=for-the-badge&logo=selenium&logoColor=white">


### 2-2. Frontend
<img src="https://img.shields.io/badge/JavaScript-F7DF1E?style=for-the-badge&logo=JavaScript&logoColor=white"> <img src="https://img.shields.io/badge/HTML5-E34F26?style=for-the-badge&logo=HTML5&logoColor=white"> <img src="https://img.shields.io/badge/CSS3-1572B6?style=for-the-badge&logo=CSS3&logoColor=white"> <img src="https://img.shields.io/badge/React-61DAFB?style=for-the-badge&logo=React&logoColor=white">


### 2-3. Infra & DevOps
<img src="https://img.shields.io/badge/Amazon%20RDS-1f77b4?style=for-the-badge&logo=Amazon%20EC2&logoColor=white"> <img src="https://img.shields.io/badge/Amazon%20EC2-FF9900?style=for-the-badge&logo=Amazon%20EC2&logoColor=white"> <img src="https://img.shields.io/badge/Amazon%20S3-569A31?style=for-the-badge&logo=Amazon%20S3&logoColor=white"> <img src="https://img.shields.io/badge/nginx-%23009639.svg?style=for-the-badge&logo=nginx&logoColor=white"> <img src="https://img.shields.io/badge/docker-%230db7ed?style=for-the-badge&logo=docker&logoColor=white"> <img src="https://img.shields.io/badge/Cloudflare-F38020?style=for-the-badge&logo=Cloudflare&logoColor=white"> 

<br>

## 3. ğŸŒ ì•„í‚¤í…ì²˜

### 3-1. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

<img width="1280" height="720" alt="Image" src="https://github.com/user-attachments/assets/150a6ccf-f6ac-45a7-94d1-974f16f0c550" />
<br>

### 3-2. DB ì„¤ê³„ (ERD)

<img width="3360" height="2689" alt="Image" src="https://github.com/user-attachments/assets/729863a4-263b-490a-9ca9-3d57c8990360" />
<br>

### 3-3. í”„ë¡œì íŠ¸ êµ¬ì¡°

<details>
<summary>í”„ë¡œì íŠ¸ êµ¬ì¡° í¼ì³ë³´ê¸°</summary>

```text
â”œâ”€â”€ myFCseoul
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ backend
â”‚   â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”‚   â”œâ”€â”€ build.gradle
â”‚   â”‚   â”œâ”€â”€ gradle
â”‚   â”‚   â”œâ”€â”€ gradle.properties
â”‚   â”‚   â”œâ”€â”€ gradlew
â”‚   â”‚   â”œâ”€â”€ gradlew.bat
â”‚   â”‚   â”œâ”€â”€ settings.gradle
â”‚   â”‚   â””â”€â”€ src
â”‚   â”‚       â”œâ”€â”€ main
â”‚   â”‚       â”‚   â”œâ”€â”€ java
â”‚   â”‚       â”‚   â”‚   â””â”€â”€ com
â”‚   â”‚       â”‚   â”‚       â””â”€â”€ myfcseoul
â”‚   â”‚       â”‚   â”‚           â””â”€â”€ backend
â”‚   â”‚       â”‚   â”‚               â”œâ”€â”€ BackendApplication.java
â”‚   â”‚       â”‚   â”‚               â”œâ”€â”€ config
â”‚   â”‚       â”‚   â”‚               â”œâ”€â”€ controller
â”‚   â”‚       â”‚   â”‚               â”œâ”€â”€ dto
â”‚   â”‚       â”‚   â”‚               â”œâ”€â”€ model
â”‚   â”‚       â”‚   â”‚               â”œâ”€â”€ repository
â”‚   â”‚       â”‚   â”‚               â””â”€â”€ service
â”‚   â”‚       â”‚   â””â”€â”€ resources
â”‚   â”‚       â”‚       â”œâ”€â”€ application.properties
â”‚   â”‚       â”‚       â””â”€â”€ templates
â”‚   â”‚       â”‚           â””â”€â”€ home.html
â”‚   â”œâ”€â”€ certbot
â”‚   â”‚   â”œâ”€â”€ log
â”‚   â”‚   â””â”€â”€ www
â”‚   â”œâ”€â”€ docker-compose.yml
â”‚   â”œâ”€â”€ frontend
â”‚   â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”‚   â”œâ”€â”€ README.md
â”‚   â”‚   â”œâ”€â”€ build
â”‚   â”‚   â”œâ”€â”€ config
â”‚   â”‚   â”œâ”€â”€ craco.config.js
â”‚   â”‚   â”œâ”€â”€ default.conf
â”‚   â”‚   â”œâ”€â”€ git
â”‚   â”‚   â”œâ”€â”€ package-lock.json
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ public
â”‚   â”‚   â”œâ”€â”€ scripts
â”‚   â”‚   â””â”€â”€ src
â”‚   â”‚       â”œâ”€â”€ App.css
â”‚   â”‚       â”œâ”€â”€ App.js
â”‚   â”‚       â”œâ”€â”€ App.test.js
â”‚   â”‚       â”œâ”€â”€ components
â”‚   â”‚       â”‚   â””â”€â”€ messenger
â”‚   â”‚       â”œâ”€â”€ css
â”‚   â”‚       â”œâ”€â”€ hooks
â”‚   â”‚       â”œâ”€â”€ index.css
â”‚   â”‚       â”œâ”€â”€ index.js
â”‚   â”‚       â”œâ”€â”€ logo.svg
â”‚   â”‚       â”œâ”€â”€ pages
â”‚   â”‚       â””â”€â”€ reportWebVitals.js
â”‚   â””â”€â”€ nginx
â”‚       â””â”€â”€ default.conf
â””â”€â”€ tree.txt
```
</details> 
<br>

## 4. ğŸ–¥ï¸ í™”ë©´ êµ¬ì„±
### 4-1. **ë¡œê·¸ì¸ í™”ë©´**
<img width="1453" height="736" alt="Image" src="https://github.com/user-attachments/assets/dcafbe68-7ae0-4b1d-bb9e-3315f33944e4" />
<br>
ì¹´ì¹´ì˜¤ OAuth 2.0ì„ í†µí•´ ê°„í¸í•˜ê²Œ ë¡œê·¸ì¸í•  ìˆ˜ ìˆëŠ” í™”ë©´<br>

---
### 4-2. **ë©”ì¸ í™”ë©´**
<img width="2438" height="2222" alt="Image" src="https://github.com/user-attachments/assets/13adbb0f-800f-4c8e-a737-eb79211e59ee" />
<br>
ê²½ê¸° ì¼ì •, ë‚˜ì˜ ì§ê´€ ì„±ì , ë­í‚¹ì„ í•œëˆˆì— ë³¼ ìˆ˜ ìˆëŠ” ëŒ€ì‹œë³´ë“œ í™”ë©´<br>

---
### 4-3. **ì§ê´€ ë“±ë¡ í™”ë©´**
<img width="1453" height="1179" alt="Image" src="https://github.com/user-attachments/assets/7a93dc28-2d29-43e9-8a93-55f333676366" />
<br>
ê´€ëŒí•œ ê²½ê¸°ì˜ í‹°ì¼“Â·ì˜ˆë§¤ ë‚´ì—­ ì‚¬ì§„ì„ ì—…ë¡œë“œí•˜ì—¬ ì§ê´€ì„ ë“±ë¡í•  ìˆ˜ ìˆëŠ” í™”ë©´  
ë“±ë¡ëœ ì§ê´€ ì •ë³´ëŠ” ì¶œì„ í†µê³„ ë° ìŠ¹ë¥  ë¶„ì„, ë­í‚¹ ì‚°ì •ì— í™œìš©<br>

---
### 4-4. **ë‹¤ì´ì–´ë¦¬ í™”ë©´**
<img width="2408" height="2672" alt="Image" src="https://github.com/user-attachments/assets/09e14743-586c-48f8-93d3-ad85ecb36539" />
<br>
ê²½ê¸° ê´€ëŒ ì†Œê°ê³¼ ì¼ìƒì„ í…ìŠ¤íŠ¸ì™€ ì‚¬ì§„ìœ¼ë¡œ ê¸°ë¡í•  ìˆ˜ ìˆëŠ” ê°œì¸ ë‹¤ì´ì–´ë¦¬ í™”ë©´<br>

---
### 4-5. **AI ê²½ê¸° ì˜ˆì¸¡ í™”ë©´**
<img width="5623" height="2964" alt="Image" src="https://github.com/user-attachments/assets/02df5148-01a6-4edf-9d8f-6b515ab33343" />
<br>
Kë¦¬ê·¸ ìˆœìœ„, ìƒëŒ€ íŒ€ ì „ì , ë‚˜ì˜ ì§ê´€ ê¸°ë¡ì„ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ìŒ ê²½ê¸° ê²°ê³¼ë¥¼ ì˜ˆì¸¡í•´ ì£¼ëŠ” í™”ë©´
OpenAI APIë¥¼ í™œìš©í•˜ì—¬ í•˜ë£¨ 1íšŒ í…ìŠ¤íŠ¸ í˜•íƒœì˜ ìƒì„¸ ì˜ˆì¸¡ ë¦¬í¬íŠ¸ë¥¼ ì œê³µ<br>

---
### 4-6. **ì±„íŒ… í™”ë©´**
<img width="1469" height="740" alt="Image" src="https://github.com/user-attachments/assets/979db278-a3d0-4ac6-95ec-0ff4c5f1feec" />
<br>
ë‹¤ë¥¸ ì‚¬ìš©ìì™€ 1:1ë¡œ ëŒ€í™”í•˜ë©° ì§ê´€ í›„ê¸°ì™€ ì‘ì› ë©”ì‹œì§€ë¥¼ ë‚˜ëˆŒ ìˆ˜ ìˆëŠ” ì±„íŒ… í™”ë©´<br>

---
### 4-7. **í”„ë¡œí•„ í™”ë©´**
<img width="1453" height="736" alt="Image" src="https://github.com/user-attachments/assets/73ea814e-0550-4b09-ba31-67fa13ecf454" />
<br>
ë¡œê·¸ì•„ì›ƒ ë° ë‹‰ë„¤ì„ ë³€ê²½ ê°€ëŠ¥í•œ í™”ë©´<br>

---
### 4-8. **ê´€ë¦¬ì ì¶œì„ ì¸ì¦ í™”ë©´**
<img width="1453" height="736" alt="Image" src="https://github.com/user-attachments/assets/37478a2d-18b3-400f-acbb-af1a3295cc81" />
<br>
ì‚¬ìš©ìê°€ ì œì¶œí•œ ì§ê´€ ì¸ì¦ ì‚¬ì§„ì„ ê´€ë¦¬ì ê³„ì •ì´ ìŠ¹ì¸Â·ê±°ì ˆí•  ìˆ˜ ìˆëŠ” í™”ë©´
ëŒ€ê¸° ì¤‘ì¸ ìš”ì²­ì˜ ê²½ê¸° ì •ë³´ì™€ ì´ë¯¸ì§€ë¥¼ í™•ì¸í•˜ê³  ë²„íŠ¼ í•œ ë²ˆìœ¼ë¡œ ì¶œì„ ì²˜ë¦¬ ìƒíƒœë¥¼ ë³€ê²½ ê°€ëŠ¥<br>


---
### 4-9. **ëª¨ë°”ì¼ í™”ë©´**
<img width="3617" height="5152" alt="Image" src="https://github.com/user-attachments/assets/e32b1c10-59df-4ff8-9e23-6ab6873cb3c4" />
<br>
ëª¨ë°”ì¼ í™˜ê²½ë„ ê³ ë ¤í•˜ì—¬ ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒì„ êµ¬ì„±<br>

---
<br>

## 5. ğŸ“Œ ì£¼ìš” ê¸°ëŠ¥ ì„¤ê³„
### 5-1. **Kakao ì†Œì…œ ë¡œê·¸ì¸ (OAuth 2.0) ê¸°ëŠ¥**
<img width="805" height="440" alt="Image" src="https://github.com/user-attachments/assets/9bf370bb-22aa-4dff-8c1f-dbf28a55b0f7" />
<br>
ì¹´ì¹´ì˜¤ OAuth 2.0 ê¸°ë°˜ ì†Œì…œ ë¡œê·¸ì¸ì„ í†µí•´ ì‚¬ìš©ìë¥¼ ì¸ì¦í•©ë‹ˆë‹¤. 

#### API ì„¤ê³„

1. **ì‚¬ìš©ì ìš”ì²­**
    - í´ë¼ì´ì–¸íŠ¸ì—ì„œ â€œì¹´ì¹´ì˜¤ ë¡œê·¸ì¸â€ ë²„íŠ¼ í´ë¦­
    - `GET /oauth2/authorization/kakao` ìš”ì²­ìœ¼ë¡œ Spring Security í•„í„° ì²´ì¸ ì§„ì…

2. **OAuth2 ë¡œê·¸ì¸ í•„í„°**
    - `OAuth2LoginAuthenticationFilter` ê°€ ë¡œê·¸ì¸ ì½œë°±(`/login/oauth2/code/kakao`) ìš”ì²­ì„ ê°€ë¡œì±”
    - `OAuth2LoginAuthenticationProvider` ì— ì¸ì¦ ì²˜ë¦¬ë¥¼ ìœ„ì„

3. **Access Token ë°œê¸‰ & ìœ ì € ì •ë³´ ì¡°íšŒ**
    - Providerê°€ ì¹´ì¹´ì˜¤ë¡œë¶€í„° **Access Token** ì„ ë°œê¸‰ë°›ìŒ
    - `OAuth2UserRequest` ìƒì„± í›„  
      `CustomOAuth2UserService.loadUser(userRequest)` í˜¸ì¶œ
    - `super.loadUser(userRequest)` ë¥¼ í†µí•´ ì¹´ì¹´ì˜¤ ìœ ì € ì •ë³´ API(`/v2/user/me`) í˜¸ì¶œ  
      â†’ `id`, `kakao_account.profile.nickname` ë“±ì˜ attributes ìˆ˜ì‹ 

4. **User ì—”í‹°í‹° ë™ê¸°í™”**
    - `UserRepository.findByUserId(kakaoId)` ë¡œ ê¸°ì¡´ ì‚¬ìš©ì ì¡°íšŒ
    - ì—†ìœ¼ë©´ ì‹ ê·œ ìƒì„±, ìˆìœ¼ë©´ ë‹‰ë„¤ì„ ë“± ì •ë³´ ê°±ì‹ 
    - ê¸°ë³¸ ê¶Œí•œì€ `user` ë¡œ ì„¤ì •, ê´€ë¦¬ì ê³„ì •ì€ `role = admin` ìœ¼ë¡œ ê´€ë¦¬
    - DB ì €ì¥ í›„, `DefaultOAuth2User(principal)` ìƒì„±

5. **SecurityContext / ì„¸ì…˜ ì €ì¥**
    - Providerê°€ `principal` ë¡œ `Authentication` ê°ì²´ ìƒì„±
    - `OAuth2LoginAuthenticationFilter` ê°€ ì´ë¥¼ **SecurityContext** ì— ì €ì¥
    - `SecurityContextPersistenceFilter` ê°€ `HttpSession(JSESSIONID)` ê³¼ ë™ê¸°í™”  
      â†’ ì´í›„ ìš”ì²­ë¶€í„°ëŠ” ì„¸ì…˜ ê¸°ë°˜ìœ¼ë¡œ ì¸ì¦ ìƒíƒœ ìœ ì§€

6. **ë¡œê·¸ì¸ ì„±ê³µ ì²˜ë¦¬**
    - `CustomOAuth2AuthenticationSuccessHandler` ì‹¤í–‰
    - `https://www.myfcseoul.com/` ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

7. **ì¸ê°€(Authorization)**
    - `SecurityConfig` ì—ì„œ URL ë³„ ì ‘ê·¼ ê¶Œí•œ ì„¤ì •
        - `/api/admin/**` : `role = admin` ì‚¬ìš©ìë§Œ ì ‘ê·¼
        - `/api/rankings`, `/api/schedule` : ì¸ì¦ ì—†ì´ í—ˆìš©
        - ê·¸ ì™¸ ëŒ€ë¶€ë¶„ì˜ API : ì¸ì¦ í•„ìˆ˜

#### ê´€ë ¨ ì†ŒìŠ¤ ì½”ë“œ

- [SecurityConfig.java](backend/src/main/java/com/myfcseoul/backend/config/SecurityConfig.java)
- [CustomOAuth2UserService.java](backend/src/main/java/com/myfcseoul/backend/service/CustomOAuth2UserService.java)
- [CustomOAuth2AuthenticationSuccessHandler.java](backend/src/main/java/com/myfcseoul/backend/service/CustomOAuth2AuthenticationSuccessHandler.java)
- [UserRepository.java](backend/src/main/java/com/myfcseoul/backend/repository/UserRepository.java)


---

### 5-2. **ì§ê´€ ê¸°ë¡ ê¸°ëŠ¥**
<img width="800" height="436" alt="Image" src="https://github.com/user-attachments/assets/66f27f0b-d777-46ad-aee0-ed064904a34b" />
<br>
ì„¸ì…˜ ê¸°ë°˜ ì¸ì¦ê³¼ Spring Data JPAë¥¼ ì´ìš©í•´ ê²½ê¸°ë³„ ì§ê´€ ì‚¬ì§„ì„ ì œì¶œí•˜ê³  <br>
ë‚˜ì˜ ì¶œì„ ë‚´ì—­ì„ ì¡°íšŒí•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.  

#### API ì„¤ê³„

1. **ì¶œì„ ì‚¬ì§„ ì œì¶œ â€“ `POST /api/mydata/submit`**
   - Request Body (JSON)
     ```json
     {
       "scheduleId": 3,
       "photoKey": "s3/attendance/2025-04-01-xxxx.jpg"
     }
     ```
   - ì²˜ë¦¬ ê³¼ì •
     - `Principal` ì—ì„œ ì¹´ì¹´ì˜¤ ê³ ìœ  IDë¥¼ êº¼ë‚´ `UserRepository.findByUserId(...)` ë¡œ `User` ì¡°íšŒ  
     - `scheduleId` ë¡œ `ScheduleRepository.findById(...)` í˜¸ì¶œ  
     - `(user, schedule)` ì¡°í•©ìœ¼ë¡œ `MyDataRepository.findByUserAndSchedule(...)` ì¡°íšŒ  
       - ì´ë¯¸ ì¡´ì¬í•˜ë©´ í•´ë‹¹ ë ˆì½”ë“œ ì—…ë°ì´íŠ¸  
       - ì—†ìœ¼ë©´ ìƒˆë¡œìš´ `MyData` ì—”í‹°í‹° ìƒì„±
     - `photoKey` ì„¸íŒ…, `attended = 0`(ìŠ¹ì¸ ëŒ€ê¸°) ë¡œ ìƒíƒœ ì €ì¥
   - ì‘ë‹µ
     - `{ "message": "ì¶œì„ ì‚¬ì§„ì´ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤. ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì…ë‹ˆë‹¤." }`

2. **ë‚˜ì˜ ì¶œì„ ë‚´ì—­ ì¡°íšŒ â€“ `GET /api/mydata`**
   - ì²˜ë¦¬ ê³¼ì •
     - `Principal` ë¡œ í˜„ì¬ ë¡œê·¸ì¸ ì‚¬ìš©ìì˜ `userId` í™•ì¸  
     - `UserRepository.findByUserId(...)` ë¡œ `User` ì—”í‹°í‹° ì¡°íšŒ  
     - `MyDataRepository.findByUser(user)` ë¡œ í•´ë‹¹ ì‚¬ìš©ìì˜ ëª¨ë“  ì¶œì„ ë°ì´í„° ì¡°íšŒ
   - ì‘ë‹µ
     - `MyData` ë¦¬ìŠ¤íŠ¸(JSON)  
       - ê° í•­ëª©ì— `attended`(0/1/2), `schedule`(ê²½ê¸° ì •ë³´), `photoKey` í¬í•¨  
       - í”„ë¡ íŠ¸ì—ì„œ ì§ê´€ íˆìŠ¤í† ë¦¬/ì¶œì„ í˜„í™©/ê·¸ë˜í”„ ë“±ì— í™œìš©

#### ê´€ë ¨ ì†ŒìŠ¤ ì½”ë“œ

- [MyDataController.java](backend/src/main/java/com/myfcseoul/backend/controller/MyDataController.java)
- [AdminMyDataController.java](backend/src/main/java/com/myfcseoul/backend/controller/AdminMyDataController.java)
- [MyDataRepository.java](backend/src/main/java/com/myfcseoul/backend/repository/MyDataRepository.java)
- [ScheduleRepository.java](backend/src/main/java/com/myfcseoul/backend/repository/ScheduleRepository.java)



---

### 5-3. **ë‹¤ì´ì–´ë¦¬ ê¸°ëŠ¥**
<img width="750" height="296" alt="Image" src="https://github.com/user-attachments/assets/c80bd3fa-5281-4071-90a8-a0c018fd8b9d" />
<br>
ê²½ê¸° ì§ê´€ í›„ ëŠë‚€ ì ê³¼ ì‚¬ì§„ì„ ë‹¤ì´ì–´ë¦¬ í˜•íƒœë¡œ ê¸°ë¡í•˜ê³ <br>
ë‹¤ë¥¸ FCì„œìš¸ íŒ¬ë“¤ì˜ ì§ê´€ ê¸°ë¡ë„ í•¨ê»˜ êµ¬ê²½í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.

#### API ì„¤ê³„

1. **ë‹¤ì´ì–´ë¦¬ ìƒì„± â€“ `POST /api/gallery`**
   - Request Body (JSON)
     ```json
     {
       "userId": "4540681543",
       "title": "ìˆ˜ì›ì „ 3:0 ì™„ìŠ¹ ì§ê´€",
       "content": "ë¶„ìœ„ê¸° ë¯¸ì³¤ë‹¤â€¦",
       "imageUrl": "https://s3.../gallery/2025-04-01-xxxx.jpg",
       "createdAt": "2025-04-01T18:30:00"
     }
     ```
   - ì²˜ë¦¬ ê³¼ì •
     - `userId`ë¡œ `UserRepository.findById(...)` í˜¸ì¶œ â†’ ì‘ì„±ì `User` ì—”í‹°í‹° ì¡°íšŒ  
     - `CreateGalleryRequestDTO` ì˜ í•„ë“œë¥¼ ì´ìš©í•´ `Gallery` ì—”í‹°í‹° ìƒì„±  
       - `user`, `title`, `content`, `imageUrl`, `createdAt` ì„¸íŒ…  
     - `GalleryRepository.save(gallery)` ë¡œ DBì— ì €ì¥  
   - ì‘ë‹µ
     - ìƒì„±ëœ `Gallery` ì—”í‹°í‹°(JSON) + `201 CREATED`

2. **íŠ¹ì • ì‚¬ìš©ìì˜ ë‹¤ì´ì–´ë¦¬ ëª©ë¡ ì¡°íšŒ â€“ `GET /api/gallery/{userId}`**
   - ì²˜ë¦¬ ê³¼ì •
     - Path Variable `{userId}`ë¥¼ ì´ìš©í•´  
       `GalleryRepository.findByUserUserId(userId)` í˜¸ì¶œ  
     - í•´ë‹¹ ì‚¬ìš©ìì˜ ë‹¤ì´ì–´ë¦¬ ëª©ë¡ì„ ìµœì‹ ìˆœ ì •ë ¬ì€ í”„ë¡ íŠ¸ì—ì„œ ìˆ˜í–‰
   - ì‘ë‹µ
     - `Gallery` ë¦¬ìŠ¤íŠ¸(JSON)  
       - ê° í•­ëª©ì— `galleryId`, `title`, `content`, `imageUrl`, `createdAt`, `user` ì •ë³´ í¬í•¨  
       - í”„ë¡ íŠ¸ì—ì„œ `/diary/{userId}` í˜ì´ì§€ì— ê·¸ë¦¬ë“œ ì¹´ë“œ í˜•íƒœë¡œ ë Œë”ë§

3. **ë‹¤ì´ì–´ë¦¬ ìˆ˜ì • â€“ `PUT /api/gallery/{galleryId}`**
   - Request Body (JSON)
     ```json
     {
       "title": "ìˆ˜ì›ì „ 3:0 ì™„ìŠ¹ ì§ê´€ (ì‚¬ì§„ ì—…ë°ì´íŠ¸)",
       "content": "í›„ë°˜ ë¶„ìœ„ê¸° ì¶”ê°€ ê¸°ë¡...",
       "imageUrl": "https://s3.../gallery/2025-04-01-updated.jpg",
       "createdAt": "2025-04-01T18:30:00"
     }
     ```
   - ì²˜ë¦¬ ê³¼ì •
     - `galleryId`ë¡œ `GalleryRepository.findById(...)` í˜¸ì¶œ â†’ ê¸°ì¡´ ë‹¤ì´ì–´ë¦¬ ì¡°íšŒ  
     - ì‘ì„±ì `user`ëŠ” ë³€ê²½í•˜ì§€ ì•Šê³ ,  
       `title`, `content`, `imageUrl`, `createdAt` í•„ë“œë§Œ ì—…ë°ì´íŠ¸  
     - `GalleryRepository.save(existing)` ë¡œ ìˆ˜ì • ë‚´ìš© ì €ì¥
   - ì‘ë‹µ
     - ìˆ˜ì •ëœ `Gallery` ì—”í‹°í‹°(JSON)

4. **ë‹¤ì´ì–´ë¦¬ ì‚­ì œ â€“ `DELETE /api/gallery/{galleryId}`**
   - ì²˜ë¦¬ ê³¼ì •
     - `GalleryRepository.deleteById(galleryId)` í˜¸ì¶œë¡œ í•´ë‹¹ ë‹¤ì´ì–´ë¦¬ ì‚­ì œ
   - ì‘ë‹µ
     - `204 No Content`

#### ê´€ë ¨ ì†ŒìŠ¤ ì½”ë“œ

- [Gallery.java](backend/src/main/java/com/myfcseoul/backend/model/Gallery.java)
- [GalleryRepository.java](backend/src/main/java/com/myfcseoul/backend/repository/GalleryRepository.java)
- [GalleryController.java](backend/src/main/java/com/myfcseoul/backend/controller/GalleryController.java)
- [CreateGalleryRequestDTO.java](backend/src/main/java/com/myfcseoul/backend/dto/CreateGalleryRequestDTO.java)
  
---

### 5-4. **AI ê²½ê¸° ì˜ˆì¸¡ ê¸°ëŠ¥**
<img width="922" height="487" alt="Image" src="https://github.com/user-attachments/assets/675e4e4d-0f57-4fe2-9463-3ee9a4732a85" />
<br>
ì‚¬ìš©ìì˜ ì§ê´€ ê¸°ë¡(ìŠ¹/ë¬´/íŒ¨), Kë¦¬ê·¸ ê³µì‹ ì‚¬ì´íŠ¸ì—ì„œ ìŠ¤í¬ë˜í•‘í•œ í˜„ì¬ ìˆœìœ„ ë° ìµœê·¼ 5ê²½ê¸° í¼
ê·¸ë¦¬ê³  DBì— ì €ì¥ëœ ë‹¤ìŒ ê²½ê¸° ì¼ì • ì •ë³´ë¥¼ ì¢…í•©í•´ì„œ OpenAI GPT ëª¨ë¸ì—ê²Œ í”„ë¡¬í”„íŠ¸ë¥¼ ì „ë‹¬í•˜ê³  ë‹¤ìŒ ê²½ê¸° ê²°ê³¼(ìŠ¹/ë¬´/íŒ¨ + ìŠ¤ì½”ì–´)ë¥¼ ë¶„ì„Â·ì˜ˆì¸¡í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

#### API ì„¤ê³„

1. **ê²½ê¸° ì˜ˆì¸¡ ìš”ì²­ â€“ `GET /api/predict?userId=...` , `POST /api/predict?userId=...`**

   - **ìš”ì²­ íŒŒë¼ë¯¸í„°**
     - `userId` : ì˜ˆì¸¡ì„ ìš”ì²­í•˜ëŠ” ì‚¬ìš©ì ID (ì¹´ì¹´ì˜¤ ê³ ìœ  ID)

   - **ì²˜ë¦¬ ê³¼ì •**
     1. `UserRepository.findById(userId)` ë¡œ ì‚¬ìš©ì ì¡°íšŒ  
        â†’ ì—†ìœ¼ë©´ `401 UNAUTHORIZED` + `"ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤."`
     2. **ì¼ë°˜ ì‚¬ìš©ì**ì¸ ê²½ìš°, `lastPredictionAt` ê¸°ì¤€ìœ¼ë¡œ  
        â†’ **í•˜ë£¨ 1íšŒë§Œ ì˜ˆì¸¡ ê°€ëŠ¥**í•˜ë„ë¡ ì œí•œ  
        - ì˜¤ëŠ˜ ì´ë¯¸ ì˜ˆì¸¡í–ˆë‹¤ë©´ `429 TOO_MANY_REQUESTS` ë°˜í™˜
     3. `MyDataService.getByUserId(userId)` ë¡œ ì‚¬ìš©ìì˜ ì§ê´€ ë°ì´í„° ì¡°íšŒ  
        - ë‚´ë¶€ì—ì„œ `MyDataRepository.findByUserUserIdAndAttended(userId, 1)` ì‹¤í–‰  
        - ìŠ¹ì¸ëœ(`attended = 1`) ì§ê´€ ë°ì´í„°ë§Œ í•„í„°ë§
     4. `ScheduleService.getNextMatch()` ë¡œ **ë‹¤ìŒ ê²½ê¸° ì¼ì •** ì¡°íšŒ
     5. `KLeagueScraperService.fetchStandings()` ë¡œ  
        Kë¦¬ê·¸ íŒ€ ìˆœìœ„ + ìµœê·¼ 5ê²½ê¸° í¼(ìŠ¹Â·ë¬´Â·íŒ¨) ìŠ¤í¬ë˜í•‘
     6. ìœ„ ì„¸ ë°ì´í„°ë¥¼ `PromptBuilder.build(...)` ì— ì „ë‹¬í•´  
        â†’ GPTì—ê²Œ ì „ë‹¬í•  **í•œêµ­ì–´ í”„ë¡¬í”„íŠ¸ ë¬¸ìì—´ ìƒì„±**
     7. `OpenAiClientService.getPrediction(prompt)` í˜¸ì¶œ  
        â†’ OpenAI Chat Completions API (`gpt-4.1-mini`)ë¡œ ì˜ˆì¸¡ ê²°ê³¼ ë¬¸ì¥ íšë“
     8. **ì¼ë°˜ ì‚¬ìš©ì**ì¸ ê²½ìš°  
        - `user.lastPredictionAt = now()`  
        - `user.lastPredictionResult = prediction`  
        ë¡œ DBì— ì €ì¥ (í•˜ë£¨ 1íšŒ ì œí•œ ë° ìºì‹œ ìš©ë„)
     9. ìµœì¢… ì˜ˆì¸¡ ê²°ê³¼ë¥¼ JSONìœ¼ë¡œ ë°˜í™˜:
        ```json
        {
          "prediction": "ì„œìš¸ì´ 2:1ë¡œ ìŠ¹ë¦¬í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤... (ì´í•˜ GPT ì‘ë‹µ)"
        }
        ```

   - **ì‘ë‹µ**
     - ì„±ê³µ: `200 OK` + `{ "prediction": "<AI ì˜ˆì¸¡ ê²°ê³¼ í…ìŠ¤íŠ¸>" }`
     - í•˜ë£¨ 1íšŒ ì œí•œ ì´ˆê³¼: `429 TOO_MANY_REQUESTS`
     - ë¯¸ë¡œê·¸ì¸ ë˜ëŠ” ì˜ëª»ëœ userId: `401 UNAUTHORIZED`

2. **ì˜¤ëŠ˜ì˜ ì˜ˆì¸¡ ê²°ê³¼ ì¡°íšŒ â€“ `GET /api/prediction`**

   - **ì¸ì¦ ë°©ì‹**
     - `Principal` ì„ ì‚¬ìš©í•´ í˜„ì¬ ì„¸ì…˜ì˜ ë¡œê·¸ì¸ ì‚¬ìš©ì ì‹ë³„  
       â†’ `principal.getName()` = ì¹´ì¹´ì˜¤ `userId`

   - **ì²˜ë¦¬ ê³¼ì •**
     1. `principal == null` ì´ë©´ `401 UNAUTHORIZED`
     2. `UserRepository.findById(principal.getName())` ë¡œ ì‚¬ìš©ì ì¡°íšŒ
     3. `user.lastPredictionAt` ì˜ ë‚ ì§œê°€ **ì˜¤ëŠ˜**ì´ê³   
        `lastPredictionResult` ê°€ ì¡´ì¬í•˜ë©´  
        â†’ ì˜¤ëŠ˜ ì´ë¯¸ ìƒì„±í•´ ë‘” ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ê·¸ëŒ€ë¡œ ë°˜í™˜
     4. ì˜¤ëŠ˜ ì˜ˆì¸¡í•œ ê¸°ë¡ì´ ì—†ë‹¤ë©´ `204 No Content` ë°˜í™˜

   - **ì‘ë‹µ ì˜ˆì‹œ**
     ```json
     {
       "prediction": "ì„œìš¸ì´ 1:0ìœ¼ë¡œ ê·¼ì†Œí•˜ê²Œ ìŠ¹ë¦¬í•  ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤..."
     }
     ```

---

#### ë‚´ë¶€ ë™ì‘ êµ¬ì„±

1. **Kë¦¬ê·¸ ìˆœìœ„Â·í¼ ìˆ˜ì§‘ â€“ `KLeagueScraperService`**
   - Selenium(ChromeDriver) + Jsoup ì‚¬ìš©
   - `https://www.kleague.com/record/team.do` ì— ì ‘ì† í›„
     - ê·¸ë£¹ A/B ìˆœìœ„ í…Œì´ë¸”(`#ts1`, `#ts2`)ì—ì„œ
     - íŒ€ëª…, ìˆœìœ„, ìµœê·¼ 5ê²½ê¸° í¼(ìŠ¹Â·ë¬´Â·íŒ¨)ì„ íŒŒì‹±
   - `Standing(group, rank, team, recentForm)` ë¦¬ìŠ¤íŠ¸ë¡œ ë°˜í™˜

2. **í”„ë¡¬í”„íŠ¸ ìƒì„± â€“ `PromptBuilder`**
   - **ì…ë ¥**
     - `List<MyData> myList` : ì‚¬ìš©ìì˜ ìŠ¹ì¸ëœ ì§ê´€ ê¸°ë¡(`attended = 1`)
     - `List<Standing> standings` : í˜„ì¬ ë¦¬ê·¸ ìˆœìœ„/í¼
     - `Schedule nextMatch` : ë‹¤ìŒ ê²½ê¸° ì •ë³´(í™ˆ/ì›ì •, ì¼ì‹œ, ì¥ì†Œ)
   - **ì²˜ë¦¬**
     - ì§ê´€ ìŠ¹/ë¬´/íŒ¨ ì¹´ìš´íŠ¸
     - ìˆœìœ„/í¼ì„ **ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” í˜•ì‹**ìœ¼ë¡œ ë³€í™˜
     - ë‹¤ìŒ ê²½ê¸° ì •ë³´ë¥¼  
       ì˜ˆ) `"ì„œìš¸ vs ëŒ€êµ¬  2025ë…„ 4ì›” 1ì¼ 19ì‹œ 00ë¶„  ì¥ì†Œ: ìƒì•”ì›”ë“œì»µê²½ê¸°ì¥"`  
       ê°™ì€ ë¬¸ì¥ìœ¼ë¡œ í¬ë§·íŒ…
     - â€œì˜ˆì¸¡ ìš”ì²­/ì–‘ì‹/ê·¼ê±° ì‘ì„± ë°©ë²•â€ì„ ìƒì„¸íˆ ì ì€  
       ê¸´ í•œêµ­ì–´ í”„ë¡¬í”„íŠ¸ ë¬¸ìì—´ ìƒì„±
   - **ì¶œë ¥**
     - OpenAI Chat APIì— ê·¸ëŒ€ë¡œ ì „ë‹¬í•  ìµœì¢… `String prompt`

3. **OpenAI í˜¸ì¶œ â€“ `OpenAiClientService`**
   - `POST https://api.openai.com/v1/chat/completions`
   - **Request Body**
     ```json
     {
       "model": "gpt-4.1-mini",
       "messages": [
         { "role": "user", "content": "<PromptBuilderê°€ ë§Œë“  í”„ë¡¬í”„íŠ¸>" }
       ],
       "temperature": 0.2
     }
     ```
   - ì‘ë‹µì—ì„œ `choices[0].message.content` ë¥¼ êº¼ë‚´  
     â†’ ìµœì¢… ì˜ˆì¸¡ ê²°ê³¼ í…ìŠ¤íŠ¸ë¡œ ì‚¬ìš©

---

#### ê´€ë ¨ ì†ŒìŠ¤ ì½”ë“œ

- [PredictionController.java](backend/src/main/java/com/myfcseoul/backend/controller/PredictionController.java)
- [OpenAiClientService.java](backend/src/main/java/com/myfcseoul/backend/service/OpenAiClientService.java)
- [PromptBuilder.java](backend/src/main/java/com/myfcseoul/backend/service/PromptBuilder.java)
- [KLeagueScraperService.java](backend/src/main/java/com/myfcseoul/backend/service/KLeagueScraperService.java)
- [MyDataService.java](backend/src/main/java/com/myfcseoul/backend/service/MyDataService.java)
- [ScheduleService.java](backend/src/main/java/com/myfcseoul/backend/service/ScheduleService.java)

---


### 5-5. **ì±„íŒ… ê¸°ëŠ¥**

<br>

---

### 5-6. **ë­í‚¹ ê¸°ëŠ¥**

<br>

---

<br>

## 6. âš ï¸ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### 1.

<br>
---

### 2. 
